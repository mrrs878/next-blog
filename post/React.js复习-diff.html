<!DOCTYPE html><html><head><link rel="icon" href="https://mrrsblog.oss-cn-shanghai.aliyuncs.com/avatar.jpg"/><script async="" src="/js/L2Dwidget.min.js"></script><script async="" src="/js/initL2D.js"></script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Mr.RSçš„ä¸ªäººåšå®¢-React.jså¤ä¹ -diff</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/15773988a510c3d3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/15773988a510c3d3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-b927671265afed5e.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-1e7421553b9673ee.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ca6aae25bc99a05f.js" defer=""></script><script src="/_next/static/chunks/899-1cd3a59abdb8ea18.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Btitle%5D-d89e1712c82a34ac.js" defer=""></script><script src="/_next/static/Ip8spgQZ45ji8gLKlLTAu/_buildManifest.js" defer=""></script><script src="/_next/static/Ip8spgQZ45ji8gLKlLTAu/_ssgManifest.js" defer=""></script><script src="/_next/static/Ip8spgQZ45ji8gLKlLTAu/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><header class="fixed top-0 py-4 left-0 right-0 h-auto px-10 shadow bg-white z-50"><nav><ul class="flex w-auto"><li class="mr-4 hover:text-yellow"><a href="/">é¦–é¡µ</a></li><li class="mx-4 hover:text-yellow"><a href="/categories">åˆ†ç±»</a></li><li class="mx-4 hover:text-yellow"><a href="/tags">æ ‡ç­¾</a></li><li class="ml-4 hover:text-yellow"><a href="/timeline">å½’æ¡£</a></li></ul></nav></header><main class="mt-20 mb-4 mx-auto justify-center w-2/3"><div class="mx-auto lg:max-w-5xl md:max-w-3xl"><article class="flex flex-col justify-around pb-16 px-4 mx-auto space-y-10 text-base"><div class="flex flex-col space-y-4"><h1 class="inline pt-10 text-4xl text-skin-primary">React.jså¤ä¹ -diff</h1><div class="text-sm space-x-2 text-skin-muted grid grid-cols-5"><span class="flex align-middle"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>2024-03-21 14:08:32</span><span class="flex align-middle"><svg class="w-5 h-5 inline-block mr-1" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1903" width="20" height="20"><path d="M257.7 752c2 0 4-0.2 6-0.5L431.9 722c2-0.4 3.9-1.3 5.3-2.8l423.9-423.9c3.9-3.9 3.9-10.2 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2c-1.9 11.1 1.5 21.9 9.4 29.8 6.6 6.4 14.9 9.9 23.8 9.9z m67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z" p-id="1904"></path></svg>2024-03-24 20:40:43</span></div></div><div class="mt-8 flex"><div class="w-full flex-auto custom-markdown-body"><div class="markdown-body" id="write">
      <h2>
        <span class="prefix"></span>
        <span class="content">Diff</span>
        <span class="suffix"></span>
      </h2>
    
      <h3>
        <span class="prefix"></span>
        <span class="content">ä»€ä¹ˆ diff</span>
        <span class="suffix"></span>
      </h3>
    <p>ç®€å•æ¥è®²å°±æ˜¯åœ¨ <code>re-render</code> æ—¶ï¼Œä»¥ä¸Šä¸€æ¬¡çš„ <code>fiber</code> æ ‘ä½œä¸ºåŸºç¡€ï¼Œä»¥è¿™æ¬¡çš„ vdom ä½œä¸ºç›®æ ‡ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ <code>fiber</code> æ ‘ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­å°½é‡å¤ç”¨æ—§çš„èŠ‚ç‚¹ã€‚åˆ†åˆ«å‘ç”Ÿåœ¨ <code>reconcile</code> é˜¶æ®µä¸­çš„ <code>beginWork</code> å’Œ <code>completeWork</code> ä¸­ï¼Œåœ¨ <code>beginWork</code> é˜¶æ®µï¼ŒReact ä¼šéå†æ–°çš„ vdomï¼Œå¹¶å°è¯•å¤ç”¨æ—§çš„ <code>fiber</code> èŠ‚ç‚¹ã€‚åœ¨ <code>completeWork</code> é˜¶æ®µï¼ŒReact ä¼šæ ¹æ®æ–°çš„ vdom å’Œæ—§çš„ <code>fiber</code> èŠ‚ç‚¹çš„æ¯”è¾ƒç»“æœï¼Œç”Ÿæˆæ–°çš„ fiber æ ‘</p>
<p>ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä¸éœ€è¦ diffï¼Œç›´æ¥ç”± vdom ç”Ÿæˆ <code>fiber</code> ã€‚å†æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿæ–°çš„ vdomï¼Œè¿™æ—¶å€™å°±éœ€è¦è¿ç”¨ diff ç®—æ³•ã€‚</p>
<p>ä¼ ç»Ÿçš„ diff ç®—æ³•ï¼Œå¯¹äºæ ‘çš„å¤„ç†ï¼Œæ—¶é—´å¤æ‚åº¦åœ¨ O(n^3)ï¼Œè¿™å¯¹äºå‰ç«¯æ¡†æ¶æ¥è¯´å¤ªæ…¢äº†ï¼Œå¼€é”€è¿‡äºé«˜æ˜‚ï¼Œå› æ­¤ä¸ºé™ä½æ—¶é—´å¤æ‚åº¦ï¼ŒReact çš„ diff ç®—æ³•ä¼šé¢„è®¾ä¸‰ä¸ªé™åˆ¶</p>
<ol>
<li><p>åªè¿›è¡ŒåŒå±‚æ¯”è¾ƒ</p>
</li>
<li><p>èŠ‚ç‚¹ <code>type</code> ä¸åŒæ—¶ï¼Œç›´æ¥åˆ é™¤èŠ‚ç‚¹ï¼ˆåŠå…¶å­å­™èŠ‚ç‚¹ï¼‰</p>
</li>
<li><p>æ ¹æ® <code>key</code> æ¥å¤ç”¨èŠ‚ç‚¹</p>
</li>
</ol>

      <h2>
        <span class="prefix"></span>
        <span class="content">ä¸ºä»€ä¹ˆè¦æœ‰ diff</span>
        <span class="suffix"></span>
      </h2>
    <p>ä¸ºä»€ä¹ˆè¦åš diff å‘¢ï¼Ÿç›´æ¥ä½¿ç”¨æ–°çš„ vdom æ›¿æ¢ä¸å¯ä»¥å—ï¼Ÿ ğŸ¤”</p>
<p>å¯ä»¥æ˜¯å¯ä»¥ï¼Œä½†æ— æ³•å®ç°ä¸€äº›åŠŸèƒ½ï¼Œæ¯”å¦‚ä¿æŒè¾“å…¥æ¡†çš„èšç„¦çŠ¶æ€ï¼Œä¸æ»‘çš„åŠ¨ç”»ç­‰ç­‰ï¼Œè€Œä¸”é¢‘ç¹åˆ›å»º dom èŠ‚ç‚¹å¯¹æµè§ˆå™¨ä¹Ÿæ˜¯ä¸å°çš„è´Ÿæ‹…ã€‚</p>
<p>è¯¶ï¼Œé‚£æˆ‘ä»¬å°±ä¸èƒ½è‡ªå·±æ¥å†³å®šå“ªäº› dom æ›´æ–°å—ï¼Ÿè¿™æ ·æ€§èƒ½ä¸æ›´é«˜æ•ˆå—ï¼Ÿ</p>
<p>å¯ä»¥æ»´ï¼Œå¯¹äºå¤æ‚é¡µé¢ï¼Œç¨‹åºå‘˜è¡¨ç¤ºè¿™ diff è°çˆ±åšè°åšï¼Œæ›´æ–°ä¸€ä¸ªèŠ‚ç‚¹æ‰ä¸€æ ¹å¤´å‘ ğŸ‘¨â€ğŸ¦²</p>
<p><strong>SSR å¹¶æ²¡æœ‰ diff</strong></p>

      <h3>
        <span class="prefix"></span>
        <span class="content">æ€§èƒ½</span>
        <span class="suffix"></span>
      </h3>
    <ol>
<li><p>åˆå¹¶å¤§é‡ dom æ“ä½œå¹¶è¿›è¡Œç»Ÿä¸€å¤„ç†ï¼Œå‡å°‘é‡ç»˜é‡æ’æ¬¡æ•°</p>
</li>
<li><p>å¤ç”¨ dom èŠ‚ç‚¹ï¼Œå‡å°‘åˆ›å»º/åˆ é™¤ dom èŠ‚ç‚¹æ¬¡æ•°ï¼Œè€Œéå…¨é‡é‡æ¸²</p>
</li>
</ol>

      <h3>
        <span class="prefix"></span>
        <span class="content">çŠ¶æ€</span>
        <span class="suffix"></span>
      </h3>
    <ol>
<li><p>ä¿æŒæŸäº›ç‰¹æ®Šçš„çŠ¶æ€</p>
</li>
<li><p>å®ç°æ›´ç»†æ»‘çš„åŠ¨ç”»</p>
</li>
</ol>

      <h2>
        <span class="prefix"></span>
        <span class="content">å¦‚ä½•å®ç° diff</span>
        <span class="suffix"></span>
      </h2>
    <p><strong>ä»¥ä¸‹è¿‡ç¨‹å‘ç”Ÿåœ¨ render é˜¶æ®µ</strong></p>
<p>æ ¸å¿ƒ--<strong>å¤ç”¨</strong></p>
<p>æ€»ç»“ï¼šåŒå±‚æ¯”è¾ƒï¼Œä½¿ç”¨ <code>key</code> å’Œ <code>type</code> å†³å®šèŠ‚ç‚¹çš„æ›´æ–°ç±»å‹ï¼ˆæ–°å¢ã€åˆ é™¤ã€ç§»åŠ¨ï¼‰ã€‚ç”±äºæ˜¯å•é“¾è¡¨å¯¹æ¯”ï¼Œæ— æ³•ä½¿ç”¨åŒæŒ‡é’ˆä¼˜åŒ–ï¼Œéœ€è¦ç»è¿‡ä¸¤æ¬¡éå†å¯¹æ¯”å‡ºç»“æœï¼š</p>
<ol>
<li><p>ç¬¬ä¸€è½®å¯¹æ¯”<code>key</code>ï¼Œç›´è‡³é‡åˆ° <code>key</code> ä¸ä¸€è‡´çš„èŠ‚ç‚¹</p>
</li>
<li><p>ç¬¬äºŒè½®ï¼Œå°†å‰©ä¸‹çš„ <code>fiber</code> èŠ‚ç‚¹å­˜å…¥ <code>map</code> ä¸­ï¼Œç»§ç»­éå†å‰©ä¸‹çš„æ–°çš„ <code>element</code> ï¼Œä» map ä¸­æŸ¥æ‰¾æ˜¯å¦èƒ½å¤ç”¨</p>
</li>
</ol>

      <h3>
        <span class="prefix"></span>
        <span class="content">èŠ‚ç‚¹ç§»åŠ¨é€»è¾‘</span>
        <span class="suffix"></span>
      </h3>
    <p>æ–°å¢/åˆ é™¤é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œè¿™é‡Œç€é‡ç ”ç©¶ä¸€ä¸‹èŠ‚ç‚¹<strong>ç§»åŠ¨</strong>é€»è¾‘</p>
<p>ä»¥ ğŸ‘‡ çš„æ•°æ®ä¸ºä¾‹</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- before --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;A&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;A&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;B&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;B&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;C&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;C&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;D&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;D&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;E&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;E&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-comment">&lt;!-- after --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;A&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;A&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;C&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;C&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;B&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;B1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;D&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;D&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;E1&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;E1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</code></pre>
<p>å…¶ä¸­ï¼Œåˆ é™¤äº† <code>li#B</code> å’Œ <code>li#E</code> ï¼Œæ–°å¢äº† <code>li#B1</code> å’Œ <code>li#E1</code> ï¼Œå°† <code>li#C</code> å‘å‰ç§»åŠ¨</p>
<p>ç¬¬ä¸€è½®éå†ï¼Œåˆ°è¾¾ <code>li#C</code> æ—¶å³åœæ­¢ï¼Œå°† <code>li#B</code> è‡³ <code>li#E</code> å­˜è‡³ <code>existingChildren</code> ä¸­ï¼Œä»¥ <code>key</code> æˆ– <code>index</code> ä½œä¸ºé”®ï¼Œæ›´æ–° <code>lastPlacedIndex</code> ä¸º 0, å¼€å¯ç¬¬äºŒè½®éå†ã€‚</p>
<p>å‘ç° <code>li#C</code> å¯ä»¥å¤ç”¨ï¼Œå°†å…¶ä» <code>existingChildren</code> ä¸­åˆ é™¤ï¼Œå¹¶æ›´æ–° <code>lastPlacedIndex</code> ä¸º 2 ï¼ˆåœ¨ <code>existingChildren</code> ä¸­çš„ä½ç½®ï¼‰ï¼›ç»§ç»­éå†</p>
<p>å‘ç° <code>li#B</code> ä¸ºæ–°å¢</p>
<p>å‘ç° <code>li#D</code> å¯å¤ç”¨ï¼Œå¹¶ä¸” <code>li#D</code> çš„ <code>index</code> å°äº <code>lastPlacedIndex</code> ï¼Œ <code>li#D</code> ä¸ç”¨ç§»åŠ¨ï¼ŒåŒæ—¶æ›´æ–° <code>existingChildren</code> ä¸º 3</p>
<p>å‘ç° <code>li#E</code> ä¸ºæ–°å¢</p>
<p>éå†ç»“æŸï¼Œæ ‡è®° <code>existingChildren</code> ä¸­å…¶ä½™èŠ‚ç‚¹ä¸ºåˆ é™¤</p>

      <h2>
        <span class="prefix"></span>
        <span class="content">å…³è”</span>
        <span class="suffix"></span>
      </h2>
    <p><a href="">åŒæŒ‡é’ˆ</a>
<a href="">æ·±åº¦ä¼˜å…ˆéå†</a></p>
</div></div></div></article></div></main><footer class="flex flex-col items-center justify-center leading-8 text-sm w-full py-2 border-t text-skin-muted"><p>Designed &amp; developed by<a class="ml-1 text-yellow" target="_blank" href="https://github.com/mrrs878" rel="noreferrer">Mr.RS</a></p><p>Â©<!-- --> <!-- -->2024</p></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"React.jså¤ä¹ -diff","tags":["React.js"],"categories":"2024å¤ä¹ ","description":"## Diff\n\n### ä»€ä¹ˆ diff\n\nç®€å•æ¥è®²å°±æ˜¯åœ¨ `re-render` æ—¶ï¼Œä»¥ä¸Šä¸€æ¬¡çš„ `fiber` æ ‘ä½œä¸ºåŸºç¡€ï¼Œä»¥è¿™æ¬¡çš„ vdom ä½œä¸ºç›®æ ‡ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ `fiber` æ ‘ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­å°½é‡å¤ç”¨æ—§çš„èŠ‚ç‚¹ã€‚åˆ†åˆ«å‘ç”Ÿåœ¨ `reconcile` é˜¶æ®µä¸­çš„ `beginWork` å’Œ `completeWork` ä¸­ï¼Œåœ¨ `beginWork` é˜¶æ®µï¼ŒReact ä¼šéå†æ–°çš„ vdomï¼Œå¹¶","createDate":"2024-03-21 14:08:32","updateDate":"2024-03-24 20:40:43","body":"\n      \u003ch2\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eDiff\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h2\u003e\n    \n      \u003ch3\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eä»€ä¹ˆ diff\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h3\u003e\n    \u003cp\u003eç®€å•æ¥è®²å°±æ˜¯åœ¨ \u003ccode\u003ere-render\u003c/code\u003e æ—¶ï¼Œä»¥ä¸Šä¸€æ¬¡çš„ \u003ccode\u003efiber\u003c/code\u003e æ ‘ä½œä¸ºåŸºç¡€ï¼Œä»¥è¿™æ¬¡çš„ vdom ä½œä¸ºç›®æ ‡ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ \u003ccode\u003efiber\u003c/code\u003e æ ‘ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­å°½é‡å¤ç”¨æ—§çš„èŠ‚ç‚¹ã€‚åˆ†åˆ«å‘ç”Ÿåœ¨ \u003ccode\u003ereconcile\u003c/code\u003e é˜¶æ®µä¸­çš„ \u003ccode\u003ebeginWork\u003c/code\u003e å’Œ \u003ccode\u003ecompleteWork\u003c/code\u003e ä¸­ï¼Œåœ¨ \u003ccode\u003ebeginWork\u003c/code\u003e é˜¶æ®µï¼ŒReact ä¼šéå†æ–°çš„ vdomï¼Œå¹¶å°è¯•å¤ç”¨æ—§çš„ \u003ccode\u003efiber\u003c/code\u003e èŠ‚ç‚¹ã€‚åœ¨ \u003ccode\u003ecompleteWork\u003c/code\u003e é˜¶æ®µï¼ŒReact ä¼šæ ¹æ®æ–°çš„ vdom å’Œæ—§çš„ \u003ccode\u003efiber\u003c/code\u003e èŠ‚ç‚¹çš„æ¯”è¾ƒç»“æœï¼Œç”Ÿæˆæ–°çš„ fiber æ ‘\u003c/p\u003e\n\u003cp\u003eç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä¸éœ€è¦ diffï¼Œç›´æ¥ç”± vdom ç”Ÿæˆ \u003ccode\u003efiber\u003c/code\u003e ã€‚å†æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿæ–°çš„ vdomï¼Œè¿™æ—¶å€™å°±éœ€è¦è¿ç”¨ diff ç®—æ³•ã€‚\u003c/p\u003e\n\u003cp\u003eä¼ ç»Ÿçš„ diff ç®—æ³•ï¼Œå¯¹äºæ ‘çš„å¤„ç†ï¼Œæ—¶é—´å¤æ‚åº¦åœ¨ O(n^3)ï¼Œè¿™å¯¹äºå‰ç«¯æ¡†æ¶æ¥è¯´å¤ªæ…¢äº†ï¼Œå¼€é”€è¿‡äºé«˜æ˜‚ï¼Œå› æ­¤ä¸ºé™ä½æ—¶é—´å¤æ‚åº¦ï¼ŒReact çš„ diff ç®—æ³•ä¼šé¢„è®¾ä¸‰ä¸ªé™åˆ¶\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eåªè¿›è¡ŒåŒå±‚æ¯”è¾ƒ\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eèŠ‚ç‚¹ \u003ccode\u003etype\u003c/code\u003e ä¸åŒæ—¶ï¼Œç›´æ¥åˆ é™¤èŠ‚ç‚¹ï¼ˆåŠå…¶å­å­™èŠ‚ç‚¹ï¼‰\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eæ ¹æ® \u003ccode\u003ekey\u003c/code\u003e æ¥å¤ç”¨èŠ‚ç‚¹\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n      \u003ch2\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eä¸ºä»€ä¹ˆè¦æœ‰ diff\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h2\u003e\n    \u003cp\u003eä¸ºä»€ä¹ˆè¦åš diff å‘¢ï¼Ÿç›´æ¥ä½¿ç”¨æ–°çš„ vdom æ›¿æ¢ä¸å¯ä»¥å—ï¼Ÿ ğŸ¤”\u003c/p\u003e\n\u003cp\u003eå¯ä»¥æ˜¯å¯ä»¥ï¼Œä½†æ— æ³•å®ç°ä¸€äº›åŠŸèƒ½ï¼Œæ¯”å¦‚ä¿æŒè¾“å…¥æ¡†çš„èšç„¦çŠ¶æ€ï¼Œä¸æ»‘çš„åŠ¨ç”»ç­‰ç­‰ï¼Œè€Œä¸”é¢‘ç¹åˆ›å»º dom èŠ‚ç‚¹å¯¹æµè§ˆå™¨ä¹Ÿæ˜¯ä¸å°çš„è´Ÿæ‹…ã€‚\u003c/p\u003e\n\u003cp\u003eè¯¶ï¼Œé‚£æˆ‘ä»¬å°±ä¸èƒ½è‡ªå·±æ¥å†³å®šå“ªäº› dom æ›´æ–°å—ï¼Ÿè¿™æ ·æ€§èƒ½ä¸æ›´é«˜æ•ˆå—ï¼Ÿ\u003c/p\u003e\n\u003cp\u003eå¯ä»¥æ»´ï¼Œå¯¹äºå¤æ‚é¡µé¢ï¼Œç¨‹åºå‘˜è¡¨ç¤ºè¿™ diff è°çˆ±åšè°åšï¼Œæ›´æ–°ä¸€ä¸ªèŠ‚ç‚¹æ‰ä¸€æ ¹å¤´å‘ ğŸ‘¨â€ğŸ¦²\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eSSR å¹¶æ²¡æœ‰ diff\u003c/strong\u003e\u003c/p\u003e\n\n      \u003ch3\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eæ€§èƒ½\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h3\u003e\n    \u003col\u003e\n\u003cli\u003e\u003cp\u003eåˆå¹¶å¤§é‡ dom æ“ä½œå¹¶è¿›è¡Œç»Ÿä¸€å¤„ç†ï¼Œå‡å°‘é‡ç»˜é‡æ’æ¬¡æ•°\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eå¤ç”¨ dom èŠ‚ç‚¹ï¼Œå‡å°‘åˆ›å»º/åˆ é™¤ dom èŠ‚ç‚¹æ¬¡æ•°ï¼Œè€Œéå…¨é‡é‡æ¸²\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n      \u003ch3\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eçŠ¶æ€\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h3\u003e\n    \u003col\u003e\n\u003cli\u003e\u003cp\u003eä¿æŒæŸäº›ç‰¹æ®Šçš„çŠ¶æ€\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eå®ç°æ›´ç»†æ»‘çš„åŠ¨ç”»\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n      \u003ch2\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eå¦‚ä½•å®ç° diff\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h2\u003e\n    \u003cp\u003e\u003cstrong\u003eä»¥ä¸‹è¿‡ç¨‹å‘ç”Ÿåœ¨ render é˜¶æ®µ\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eæ ¸å¿ƒ--\u003cstrong\u003eå¤ç”¨\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eæ€»ç»“ï¼šåŒå±‚æ¯”è¾ƒï¼Œä½¿ç”¨ \u003ccode\u003ekey\u003c/code\u003e å’Œ \u003ccode\u003etype\u003c/code\u003e å†³å®šèŠ‚ç‚¹çš„æ›´æ–°ç±»å‹ï¼ˆæ–°å¢ã€åˆ é™¤ã€ç§»åŠ¨ï¼‰ã€‚ç”±äºæ˜¯å•é“¾è¡¨å¯¹æ¯”ï¼Œæ— æ³•ä½¿ç”¨åŒæŒ‡é’ˆä¼˜åŒ–ï¼Œéœ€è¦ç»è¿‡ä¸¤æ¬¡éå†å¯¹æ¯”å‡ºç»“æœï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eç¬¬ä¸€è½®å¯¹æ¯”\u003ccode\u003ekey\u003c/code\u003eï¼Œç›´è‡³é‡åˆ° \u003ccode\u003ekey\u003c/code\u003e ä¸ä¸€è‡´çš„èŠ‚ç‚¹\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eç¬¬äºŒè½®ï¼Œå°†å‰©ä¸‹çš„ \u003ccode\u003efiber\u003c/code\u003e èŠ‚ç‚¹å­˜å…¥ \u003ccode\u003emap\u003c/code\u003e ä¸­ï¼Œç»§ç»­éå†å‰©ä¸‹çš„æ–°çš„ \u003ccode\u003eelement\u003c/code\u003e ï¼Œä» map ä¸­æŸ¥æ‰¾æ˜¯å¦èƒ½å¤ç”¨\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n      \u003ch3\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eèŠ‚ç‚¹ç§»åŠ¨é€»è¾‘\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h3\u003e\n    \u003cp\u003eæ–°å¢/åˆ é™¤é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œè¿™é‡Œç€é‡ç ”ç©¶ä¸€ä¸‹èŠ‚ç‚¹\u003cstrong\u003eç§»åŠ¨\u003c/strong\u003eé€»è¾‘\u003c/p\u003e\n\u003cp\u003eä»¥ ğŸ‘‡ çš„æ•°æ®ä¸ºä¾‹\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-html\"\u003e\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- before --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eul\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;B\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;B\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;C\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;C\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;D\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;D\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;E\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;E\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eul\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- after --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eul\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;C\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;C\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;B\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;B1\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;D\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;D\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;E1\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;E1\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eul\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eå…¶ä¸­ï¼Œåˆ é™¤äº† \u003ccode\u003eli#B\u003c/code\u003e å’Œ \u003ccode\u003eli#E\u003c/code\u003e ï¼Œæ–°å¢äº† \u003ccode\u003eli#B1\u003c/code\u003e å’Œ \u003ccode\u003eli#E1\u003c/code\u003e ï¼Œå°† \u003ccode\u003eli#C\u003c/code\u003e å‘å‰ç§»åŠ¨\u003c/p\u003e\n\u003cp\u003eç¬¬ä¸€è½®éå†ï¼Œåˆ°è¾¾ \u003ccode\u003eli#C\u003c/code\u003e æ—¶å³åœæ­¢ï¼Œå°† \u003ccode\u003eli#B\u003c/code\u003e è‡³ \u003ccode\u003eli#E\u003c/code\u003e å­˜è‡³ \u003ccode\u003eexistingChildren\u003c/code\u003e ä¸­ï¼Œä»¥ \u003ccode\u003ekey\u003c/code\u003e æˆ– \u003ccode\u003eindex\u003c/code\u003e ä½œä¸ºé”®ï¼Œæ›´æ–° \u003ccode\u003elastPlacedIndex\u003c/code\u003e ä¸º 0, å¼€å¯ç¬¬äºŒè½®éå†ã€‚\u003c/p\u003e\n\u003cp\u003eå‘ç° \u003ccode\u003eli#C\u003c/code\u003e å¯ä»¥å¤ç”¨ï¼Œå°†å…¶ä» \u003ccode\u003eexistingChildren\u003c/code\u003e ä¸­åˆ é™¤ï¼Œå¹¶æ›´æ–° \u003ccode\u003elastPlacedIndex\u003c/code\u003e ä¸º 2 ï¼ˆåœ¨ \u003ccode\u003eexistingChildren\u003c/code\u003e ä¸­çš„ä½ç½®ï¼‰ï¼›ç»§ç»­éå†\u003c/p\u003e\n\u003cp\u003eå‘ç° \u003ccode\u003eli#B\u003c/code\u003e ä¸ºæ–°å¢\u003c/p\u003e\n\u003cp\u003eå‘ç° \u003ccode\u003eli#D\u003c/code\u003e å¯å¤ç”¨ï¼Œå¹¶ä¸” \u003ccode\u003eli#D\u003c/code\u003e çš„ \u003ccode\u003eindex\u003c/code\u003e å°äº \u003ccode\u003elastPlacedIndex\u003c/code\u003e ï¼Œ \u003ccode\u003eli#D\u003c/code\u003e ä¸ç”¨ç§»åŠ¨ï¼ŒåŒæ—¶æ›´æ–° \u003ccode\u003eexistingChildren\u003c/code\u003e ä¸º 3\u003c/p\u003e\n\u003cp\u003eå‘ç° \u003ccode\u003eli#E\u003c/code\u003e ä¸ºæ–°å¢\u003c/p\u003e\n\u003cp\u003eéå†ç»“æŸï¼Œæ ‡è®° \u003ccode\u003eexistingChildren\u003c/code\u003e ä¸­å…¶ä½™èŠ‚ç‚¹ä¸ºåˆ é™¤\u003c/p\u003e\n\n      \u003ch2\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eå…³è”\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h2\u003e\n    \u003cp\u003e\u003ca href=\"\"\u003eåŒæŒ‡é’ˆ\u003c/a\u003e\n\u003ca href=\"\"\u003eæ·±åº¦ä¼˜å…ˆéå†\u003c/a\u003e\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/post/[title]","query":{"title":"React.jså¤ä¹ -diff"},"buildId":"Ip8spgQZ45ji8gLKlLTAu","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>