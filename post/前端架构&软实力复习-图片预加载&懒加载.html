<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Mr.RS的个人博客-前端架构&amp;软实力复习-图片预加载&amp;懒加载</title><meta name="next-head-count" content="3"/><link rel="preload" href="/next-blog/_next/static/css/d3bd3b56eb8829d9.css" as="style"/><link rel="stylesheet" href="/next-blog/_next/static/css/d3bd3b56eb8829d9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/next-blog/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/next-blog/_next/static/chunks/webpack-cf185e4b59cdddcf.js" defer=""></script><script src="/next-blog/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/next-blog/_next/static/chunks/main-1c9e93b8392c1bc9.js" defer=""></script><script src="/next-blog/_next/static/chunks/pages/_app-ca6aae25bc99a05f.js" defer=""></script><script src="/next-blog/_next/static/chunks/899-1cd3a59abdb8ea18.js" defer=""></script><script src="/next-blog/_next/static/chunks/pages/post/%5Btitle%5D-216eae5ddb3b6d26.js" defer=""></script><script src="/next-blog/_next/static/F-e4AznjTaOhInGpG8Q5u/_buildManifest.js" defer=""></script><script src="/next-blog/_next/static/F-e4AznjTaOhInGpG8Q5u/_ssgManifest.js" defer=""></script><script src="/next-blog/_next/static/F-e4AznjTaOhInGpG8Q5u/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><header class="fixed top-0 py-4 left-0 right-0 h-auto px-10 shadow bg-white z-50"><nav><ul class="flex w-auto"><li class="mr-4 hover:text-yellow"><a href="/next-blog">首页</a></li><li class="mx-4 hover:text-yellow"><a href="/next-blog/categories">分类</a></li><li class="mx-4 hover:text-yellow"><a href="/next-blog/tags">标签</a></li><li class="ml-4 hover:text-yellow"><a href="/next-blog/timeline">归档</a></li></ul></nav></header><main class="mt-20 mb-4 mx-auto justify-center w-2/3"><div class="mx-auto lg:max-w-5xl md:max-w-3xl"><article class="flex flex-col justify-around pb-16 px-4 mx-auto space-y-10 text-base"><div class="flex flex-col space-y-4"><h1 class="inline pt-10 text-4xl text-skin-primary">前端架构&amp;软实力复习-图片预加载&amp;懒加载</h1><div class="text-sm space-x-2 text-skin-muted grid grid-cols-5"><span class="flex align-middle"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>2021-05-27 10:17:46</span><span class="flex align-middle"><svg class="w-5 h-5 inline-block mr-1" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1903" width="20" height="20"><path d="M257.7 752c2 0 4-0.2 6-0.5L431.9 722c2-0.4 3.9-1.3 5.3-2.8l423.9-423.9c3.9-3.9 3.9-10.2 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2c-1.9 11.1 1.5 21.9 9.4 29.8 6.6 6.4 14.9 9.9 23.8 9.9z m67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z" p-id="1904"></path></svg>2021-05-27 18:42:04</span><span class="flex align-middle"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>44</span></div></div><div class="mt-8 flex"><div class="w-full flex-auto custom-markdown-body"><div class="markdown-body" id="write"><h2 id="预加载">预加载</h2>
<p><code>new</code>一个新的<code>Image</code>，给<code>Image</code>的<code>src</code>赋值为真正的<code>src</code>；该<code>Image</code>在加载完毕后相应的图片资源就会在本地缓存</p>
<h2 id="懒加载">懒加载</h2>
<p>首先设置一个把<code>src</code>设置为临时的<code>data-src</code>属性，<code>src</code>设置为一个loading图，待当前元素出现在视口后用<code>data-src</code>替换<code>src</code></p>
<p>可供实现的方案：</p>
<ul>
<li><p><code>window.onscroll（节流）</code> + <code>clientTop</code> + <code>offsetTop</code> + <code>clientHieght</code> + <code>scrollTop</code></p>
<p>  不容易判断元素位置</p>
</li>
<li><p><code>widnow.onscroll（节流）</code> + <code>Element.getBoundingClientRect()</code></p>
<p>  <code>getBoundingClientRect()</code>会触发回流</p>
</li>
<li><p><code>IntersectionObserver</code> + <a href="https://github.com/Financial-Times/polyfill-library/blob/master/polyfills/IntersectionObserver/polyfill.js">polyfill</a></p>
</li>
<li><p><code>img</code>的<code>lazy</code>属性</p>
<p>  兼容性差</p>
</li>
</ul>
<p>以<code>IntersectionObserver</code>为实现方案：</p>
<pre><code class="hljs language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;height: 100vh;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;img&quot;</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">&quot;https://mrrsblog.oss-cn-shanghai.aliyuncs.com/avatar.jpg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(<span class="hljs-function">(<span class="hljs-params">changes</span>) =&gt;</span> {
      changes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">change</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (change.<span class="hljs-property">isIntersecting</span>) {
          <span class="hljs-keyword">const</span> img = change.<span class="hljs-property">target</span>;
          img.<span class="hljs-property">src</span> = img.<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span>;
          <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">deleteProperty</span>(img.<span class="hljs-property">dataset</span>, <span class="hljs-string">&#x27;src&#x27;</span>);
          observer.<span class="hljs-title function_">unobserve</span>(img);
        }
      })
    });
    observer.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#img&#x27;</span>));
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
      <span class="hljs-comment">// todo 添加节流</span>
     <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;scroll&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> innerHeight = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">clientHeight</span>;
      <span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#img&quot;</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(img.<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span>);
      <span class="hljs-keyword">const</span> { left, right, top, bottom } = img.<span class="hljs-title function_">getBoundingClientRect</span>();
      <span class="hljs-keyword">if</span> (innerHeight &gt; top &amp;&amp; bottom &gt; -<span class="hljs-number">30</span>) {
        img.<span class="hljs-property">src</span> = img.<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span>;
        <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">deleteProperty</span>(img.<span class="hljs-property">dataset</span>, <span class="hljs-string">&#x27;src&#x27;</span>);
      }
    })
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
</div></div></div></article></div></main><footer class="flex flex-col items-center justify-center leading-8 text-sm w-full py-2 border-t text-skin-muted"><p>Designed &amp; developed by<a class="ml-1 text-yellow" target="_blank" href="https://github.com/mrrs878" rel="noreferrer">Mr.RS</a></p><p>©<!-- --> <!-- -->2022</p></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"前端架构\u0026软实力复习-图片预加载\u0026懒加载","tags":["预加载","懒加载"],"categories":"2021复习","description":"## 预加载\n\n`new`一个新的`Image`，给`Image`的`src`赋值为真正的`src`；该`Image`在加载完毕后相应的图片资源就会在本地缓存\n\n## 懒加载\n\n首先设置一个把`src`设置为临时的`data-src`属性，`src`设置为一个loading图，待当前元素出现在视口后用`data-src`替换`src`\n\n可供实现的方案：\n\n- `window.onscroll","createDate":"2021-05-27 10:17:46","updateDate":"2021-05-27 18:42:04","body":"\u003ch2 id=\"预加载\"\u003e预加载\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003enew\u003c/code\u003e一个新的\u003ccode\u003eImage\u003c/code\u003e，给\u003ccode\u003eImage\u003c/code\u003e的\u003ccode\u003esrc\u003c/code\u003e赋值为真正的\u003ccode\u003esrc\u003c/code\u003e；该\u003ccode\u003eImage\u003c/code\u003e在加载完毕后相应的图片资源就会在本地缓存\u003c/p\u003e\n\u003ch2 id=\"懒加载\"\u003e懒加载\u003c/h2\u003e\n\u003cp\u003e首先设置一个把\u003ccode\u003esrc\u003c/code\u003e设置为临时的\u003ccode\u003edata-src\u003c/code\u003e属性，\u003ccode\u003esrc\u003c/code\u003e设置为一个loading图，待当前元素出现在视口后用\u003ccode\u003edata-src\u003c/code\u003e替换\u003ccode\u003esrc\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e可供实现的方案：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003ewindow.onscroll（节流）\u003c/code\u003e + \u003ccode\u003eclientTop\u003c/code\u003e + \u003ccode\u003eoffsetTop\u003c/code\u003e + \u003ccode\u003eclientHieght\u003c/code\u003e + \u003ccode\u003escrollTop\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e  不容易判断元素位置\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003ewidnow.onscroll（节流）\u003c/code\u003e + \u003ccode\u003eElement.getBoundingClientRect()\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e  \u003ccode\u003egetBoundingClientRect()\u003c/code\u003e会触发回流\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eIntersectionObserver\u003c/code\u003e + \u003ca href=\"https://github.com/Financial-Times/polyfill-library/blob/master/polyfills/IntersectionObserver/polyfill.js\"\u003epolyfill\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eimg\u003c/code\u003e的\u003ccode\u003elazy\u003c/code\u003e属性\u003c/p\u003e\n\u003cp\u003e  兼容性差\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e以\u003ccode\u003eIntersectionObserver\u003c/code\u003e为实现方案：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-html\"\u003e\u003cspan class=\"hljs-meta\"\u003e\u0026lt;!DOCTYPE \u003cspan class=\"hljs-keyword\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ehtml\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003elang\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;en\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ehead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003echarset\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;UTF-8\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehttp-equiv\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;X-UA-Compatible\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;IE=edge\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;viewport\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;width=device-width, initial-scale=1.0\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etitle\u003c/span\u003e\u0026gt;\u003c/span\u003eDocument\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etitle\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ehead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;height: 100vh;\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eimg\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;img\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edata-src\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;https://mrrsblog.oss-cn-shanghai.aliyuncs.com/avatar.jpg\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ealt\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrcset\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"language-javascript\"\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e observer = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eIntersectionObserver\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003echanges\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n      changes.\u003cspan class=\"hljs-title function_\"\u003eforEach\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003echange\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (change.\u003cspan class=\"hljs-property\"\u003eisIntersecting\u003c/span\u003e) {\n          \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e img = change.\u003cspan class=\"hljs-property\"\u003etarget\u003c/span\u003e;\n          img.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e = img.\u003cspan class=\"hljs-property\"\u003edataset\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e;\n          \u003cspan class=\"hljs-title class_\"\u003eReflect\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003edeleteProperty\u003c/span\u003e(img.\u003cspan class=\"hljs-property\"\u003edataset\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;src\u0026#x27;\u003c/span\u003e);\n          observer.\u003cspan class=\"hljs-title function_\"\u003eunobserve\u003c/span\u003e(img);\n        }\n      })\n    });\n    observer.\u003cspan class=\"hljs-title function_\"\u003eobserve\u003c/span\u003e(\u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;#img\u0026#x27;\u003c/span\u003e));\n  \u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"language-javascript\"\u003e\n      \u003cspan class=\"hljs-comment\"\u003e// todo 添加节流\u003c/span\u003e\n     \u003cspan class=\"hljs-variable language_\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;scroll\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e innerHeight = \u003cspan class=\"hljs-variable language_\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003einnerHeight\u003c/span\u003e || \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edocumentElement\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eclientHeight\u003c/span\u003e || \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ebody\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eclientHeight\u003c/span\u003e;\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e img = \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;#img\u0026quot;\u003c/span\u003e);\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(img.\u003cspan class=\"hljs-property\"\u003edataset\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { left, right, top, bottom } = img.\u003cspan class=\"hljs-title function_\"\u003egetBoundingClientRect\u003c/span\u003e();\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (innerHeight \u0026gt; top \u0026amp;\u0026amp; bottom \u0026gt; -\u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e) {\n        img.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e = img.\u003cspan class=\"hljs-property\"\u003edataset\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e;\n        \u003cspan class=\"hljs-title class_\"\u003eReflect\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003edeleteProperty\u003c/span\u003e(img.\u003cspan class=\"hljs-property\"\u003edataset\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;src\u0026#x27;\u003c/span\u003e);\n      }\n    })\n  \u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n"}},"__N_SSG":true},"page":"/post/[title]","query":{"title":"前端架构\u0026软实力复习-图片预加载\u0026懒加载"},"buildId":"F-e4AznjTaOhInGpG8Q5u","assetPrefix":"/next-blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>