<!DOCTYPE html><html><head><link rel="icon" href="https://mrrsblog.oss-cn-shanghai.aliyuncs.com/avatar.jpg"/><script async="" src="/js/L2Dwidget.min.js"></script><script async="" src="/js/initL2D.js"></script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Mr.RS的个人博客-Web Component-处理数据</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/cd72816920092dcb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cd72816920092dcb.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-b927671265afed5e.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-1e7421553b9673ee.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ca6aae25bc99a05f.js" defer=""></script><script src="/_next/static/chunks/899-1cd3a59abdb8ea18.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Btitle%5D-216eae5ddb3b6d26.js" defer=""></script><script src="/_next/static/CZ6Uu2i9da2HCumDfSdj1/_buildManifest.js" defer=""></script><script src="/_next/static/CZ6Uu2i9da2HCumDfSdj1/_ssgManifest.js" defer=""></script><script src="/_next/static/CZ6Uu2i9da2HCumDfSdj1/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><header class="fixed top-0 py-4 left-0 right-0 h-auto px-10 shadow bg-white z-50"><nav><ul class="flex w-auto"><li class="mr-4 hover:text-yellow"><a href="/">首页</a></li><li class="mx-4 hover:text-yellow"><a href="/categories">分类</a></li><li class="mx-4 hover:text-yellow"><a href="/tags">标签</a></li><li class="ml-4 hover:text-yellow"><a href="/timeline">归档</a></li></ul></nav></header><main class="mt-20 mb-4 mx-auto justify-center w-2/3"><div class="mx-auto lg:max-w-5xl md:max-w-3xl"><article class="flex flex-col justify-around pb-16 px-4 mx-auto space-y-10 text-base"><div class="flex flex-col space-y-4"><h1 class="inline pt-10 text-4xl text-skin-primary">Web Component-处理数据</h1><div class="text-sm space-x-2 text-skin-muted grid grid-cols-5"><span class="flex align-middle"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>2022-04-24 22:00:47</span><span class="flex align-middle"><svg class="w-5 h-5 inline-block mr-1" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1903" width="20" height="20"><path d="M257.7 752c2 0 4-0.2 6-0.5L431.9 722c2-0.4 3.9-1.3 5.3-2.8l423.9-423.9c3.9-3.9 3.9-10.2 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2c-1.9 11.1 1.5 21.9 9.4 29.8 6.6 6.4 14.9 9.9 23.8 9.9z m67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z" p-id="1904"></path></svg>2022-04-23 22:54:37</span><span class="flex align-middle"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>44</span></div></div><div class="mt-8 flex"><div class="w-full flex-auto custom-markdown-body"><div class="markdown-body" id="write"><p>在前一篇中，我们开发了一个<code>Reply</code>组件，大概长这样</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fa68a485f5242f5b5e1eb75dfc801c1~tplv-k3u1fbpfcp-zoom-1.image" alt="web component reply"></p>
<p>功能是完成了，不过今天浏览看到一篇文章<a href="https://itnext.io/handling-data-with-web-components-9e7e4a452e6e">Handling data with Web Components</a>，大概是介绍了 Web Component 中数据交互的几种方式，有不少收获，特此总结记录一下</p>

      <h2>
        <span class="prefix"></span>
        <span class="content">attribute VS property</span>
        <span class="suffix"></span>
      </h2>
    <p>首先是<code>attribute</code>和<code>property</code>，我们之前的代码中使用的是<code>attribute</code>来将<code>comments</code>传递到组件中，组件拿到后开始渲染数据。这种方案有一个弊端：<code>attribute</code>只接收字符串类型的数据，由于<code>comments</code>是一个数组类型，因此我们在传递之前需要使用<code>JSON.stringify</code>一下以及使用数据时需要<code>JSON.parse</code>一下，使用起来有一些不够方便</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// 更新comments时需要处理成字符串</span>
reply.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;comments&quot;</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(comments));

<span class="hljs-comment">// 使用时需要解析成数组</span>
<span class="hljs-keyword">if</span> (name === <span class="hljs-string">&quot;comments&quot;</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderComments</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(newValue));
}
</code></pre>
<p>那么有没有一种更好的方式来取代这种方式呢？有的，可以使用<code>property</code>来传递数据</p>
<p><code>property</code>和<code>attribute</code>中文翻译过来意思很接近，但实际上是有不小的区别</p>
<p>考虑下面这一行代码</p>
<pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Age:&quot;</span> /&gt;</span>
</code></pre>
<p><code>type</code>和<code>value</code>就是<code>input</code>标签的<em>attribute</em></p>
<p>当浏览器编译完 HTML 代码，会生成与之对应的一个个 DOM 节点，每个 DOM 节点是一个对象，此时它又拥有很多<em>property</em>，例如<code>height</code>、<code>alt</code>、<code>checked</code>等</p>
<p>对于一个 DOM 节点对象来讲，<code>property</code>就是这个对象上的属性；<code>attribute</code>是该对象对应的 HTML 标签元素上的属性</p>
<p><code>property</code>和<code>attribute</code>大致上一一对应，但也有些特例，比如上述<code>input</code>标签的<code>value</code>。DOM 节点对象上的<code>value</code>会在输入之后发生变化，假如用户输入的是<code>John</code>，那么此时<code>Input.value</code>的返回值是<code>John</code>，而<code>Input.getAttribute(&#39;value&#39;)</code>的返回值则是<code>Name:</code>。此外还有其他的一些特例，感兴趣的可以去这里<a href="https://stackoverflow.com/questions/6003819/what-is-the-difference-between-properties-and-attributes-in-html/6004028#6004028">What is the difference between properties and attributes in HTML</a>看看原文</p>
<p>既然<code>property</code>是对象上的一个属性，那个肯定也可以给它赋一个对象类型的值！接下来就使用<code>property</code>来重构<code>Reply</code>组件</p>

      <h2>
        <span class="prefix"></span>
        <span class="content">使用 property 重构组件</span>
        <span class="suffix"></span>
      </h2>
    <p>其实修改起来非常方便，代码改动还是比较少的</p>
<p>首先是最下面给组件更新值的代码需要变动：不再使用<code>setAttribute</code>，而是直接设置<code>comments</code>属性</p>
<pre><code class="hljs language-js">reply.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;comments&quot;</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(comments));

<span class="hljs-comment">// 修改为 ⬇️</span>

reply.<span class="hljs-property">comments</span> = comments;
</code></pre>
<p>其次，我们需要一对<code>getter</code>和<code>setter</code>来监听数据变化从而渲染新的值</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Reply</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 在这里，我们使用_comments来保存comments数据</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_comments</span> = [];
  }
  <span class="hljs-keyword">get</span> <span class="hljs-title function_">comments</span>() {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_comments</span>;
  }

  <span class="hljs-keyword">set</span> <span class="hljs-title function_">comments</span>(<span class="hljs-params">newValue</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_comments</span> = newValue;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderComments</span>(newValue);
  }
}
</code></pre>
<p>同时，删除监听<code>comments</code>属性相关的代码，因为我们这个已经通过<code>setter</code>实现数据监听了</p>
<p>到这里，我们已经完成重构，实现组件的原本功能了</p>
<p>不过我们要更新一步！</p>
<p>既然我们都能传递数组进去了，那么在大胆点，可不可以传递一个函数呢？</p>
<p>当然可以！！！</p>
<p>我们可以直接在<code>reply</code>上挂载一个<code>onSubmitComment</code>函数，在<code>Reply</code>内部按钮点击时调用该回调，并将数据传递出来</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// 直接在组件实例上挂载一个回调函数</span>
reply.<span class="hljs-property">onSubmitComment</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  comments.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">comment</span>: e,
    nickName,
    avatar,
  });
  reply.<span class="hljs-property">comments</span> = comments;
};

<span class="hljs-comment">// 组件内部，点击按钮时调用该函数</span>
submitBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">onSubmitComment</span>?.(commentInput.<span class="hljs-property">value</span>);
  commentInput.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;&quot;</span>;
});
</code></pre>
<p>芜湖～ 🎉</p>
<p>完整代码<a href="https://github.com/mrrs878/web-components/blob/main/reply-property.html">在这里</a></p>

      <h2>
        <span class="prefix"></span>
        <span class="content">总结</span>
        <span class="suffix"></span>
      </h2>
    <p><code>attribute</code>只能传递字符串数据，<code>property</code>由于是 DOM 对象上的属性，因此可以传递诸如对象、函数等复杂类型的数据。</p>
<p>据此，我们可以使用<code>property</code>来将数据直接设置到组件实例上，组件内部新增一对<code>getter</code>和<code>setter</code>来接收数据，而且我们还可以直接在组件实例上挂载一个回调函数，在组件内部可以直接调用该回调。</p>
<p>此外在处理类似于<code>disable</code>这种类型的<code>attribute</code>时也可以使用<code>property</code>+<code>getter</code>和<code>setter</code>来实现布尔类型属性的设置</p>
<p>总之，<code>attribute</code>和<code>property</code>搭配使用将极大提高开发效率</p>

      <h2>
        <span class="prefix"></span>
        <span class="content">参考</span>
        <span class="suffix"></span>
      </h2>
    <p><a href="https://stackoverflow.com/questions/6003819/what-is-the-difference-between-properties-and-attributes-in-html/6004028#6004028">What is the difference between properties and attributes in HTML</a></p>
<p><a href="https://itnext.io/handling-data-with-web-components-9e7e4a452e6e"># Handling data with Web Components</a></p>
</div></div></div></article></div></main><footer class="flex flex-col items-center justify-center leading-8 text-sm w-full py-2 border-t text-skin-muted"><p>Designed &amp; developed by<a class="ml-1 text-yellow" target="_blank" href="https://github.com/mrrs878" rel="noreferrer">Mr.RS</a></p><p>©<!-- --> <!-- -->2022</p></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Web Component-处理数据","tags":["微前端","WebComponent","Attribute","Property"],"categories":"微前端","description":"在前一篇中，我们开发了一个`Reply`组件，大概长这样\n\n![web component reply](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fa68a485f5242f5b5e1eb75dfc801c1~tplv-k3u1fbpfcp-zoom-1.image)\n\n功能是完成了，不过今天浏览看到一篇文章[Handling dat","createDate":"2022-04-24 22:00:47","updateDate":"2022-04-23 22:54:37","body":"\u003cp\u003e在前一篇中，我们开发了一个\u003ccode\u003eReply\u003c/code\u003e组件，大概长这样\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fa68a485f5242f5b5e1eb75dfc801c1~tplv-k3u1fbpfcp-zoom-1.image\" alt=\"web component reply\"\u003e\u003c/p\u003e\n\u003cp\u003e功能是完成了，不过今天浏览看到一篇文章\u003ca href=\"https://itnext.io/handling-data-with-web-components-9e7e4a452e6e\"\u003eHandling data with Web Components\u003c/a\u003e，大概是介绍了 Web Component 中数据交互的几种方式，有不少收获，特此总结记录一下\u003c/p\u003e\n\n      \u003ch2\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003eattribute VS property\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h2\u003e\n    \u003cp\u003e首先是\u003ccode\u003eattribute\u003c/code\u003e和\u003ccode\u003eproperty\u003c/code\u003e，我们之前的代码中使用的是\u003ccode\u003eattribute\u003c/code\u003e来将\u003ccode\u003ecomments\u003c/code\u003e传递到组件中，组件拿到后开始渲染数据。这种方案有一个弊端：\u003ccode\u003eattribute\u003c/code\u003e只接收字符串类型的数据，由于\u003ccode\u003ecomments\u003c/code\u003e是一个数组类型，因此我们在传递之前需要使用\u003ccode\u003eJSON.stringify\u003c/code\u003e一下以及使用数据时需要\u003ccode\u003eJSON.parse\u003c/code\u003e一下，使用起来有一些不够方便\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 更新comments时需要处理成字符串\u003c/span\u003e\nreply.\u003cspan class=\"hljs-title function_\"\u003esetAttribute\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;comments\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003estringify\u003c/span\u003e(comments));\n\n\u003cspan class=\"hljs-comment\"\u003e// 使用时需要解析成数组\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (name === \u003cspan class=\"hljs-string\"\u003e\u0026quot;comments\u0026quot;\u003c/span\u003e) {\n  \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003erenderComments\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eparse\u003c/span\u003e(newValue));\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e那么有没有一种更好的方式来取代这种方式呢？有的，可以使用\u003ccode\u003eproperty\u003c/code\u003e来传递数据\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eproperty\u003c/code\u003e和\u003ccode\u003eattribute\u003c/code\u003e中文翻译过来意思很接近，但实际上是有不小的区别\u003c/p\u003e\n\u003cp\u003e考虑下面这一行代码\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-html\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003einput\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;Age:\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003etype\u003c/code\u003e和\u003ccode\u003evalue\u003c/code\u003e就是\u003ccode\u003einput\u003c/code\u003e标签的\u003cem\u003eattribute\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e当浏览器编译完 HTML 代码，会生成与之对应的一个个 DOM 节点，每个 DOM 节点是一个对象，此时它又拥有很多\u003cem\u003eproperty\u003c/em\u003e，例如\u003ccode\u003eheight\u003c/code\u003e、\u003ccode\u003ealt\u003c/code\u003e、\u003ccode\u003echecked\u003c/code\u003e等\u003c/p\u003e\n\u003cp\u003e对于一个 DOM 节点对象来讲，\u003ccode\u003eproperty\u003c/code\u003e就是这个对象上的属性；\u003ccode\u003eattribute\u003c/code\u003e是该对象对应的 HTML 标签元素上的属性\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eproperty\u003c/code\u003e和\u003ccode\u003eattribute\u003c/code\u003e大致上一一对应，但也有些特例，比如上述\u003ccode\u003einput\u003c/code\u003e标签的\u003ccode\u003evalue\u003c/code\u003e。DOM 节点对象上的\u003ccode\u003evalue\u003c/code\u003e会在输入之后发生变化，假如用户输入的是\u003ccode\u003eJohn\u003c/code\u003e，那么此时\u003ccode\u003eInput.value\u003c/code\u003e的返回值是\u003ccode\u003eJohn\u003c/code\u003e，而\u003ccode\u003eInput.getAttribute(\u0026#39;value\u0026#39;)\u003c/code\u003e的返回值则是\u003ccode\u003eName:\u003c/code\u003e。此外还有其他的一些特例，感兴趣的可以去这里\u003ca href=\"https://stackoverflow.com/questions/6003819/what-is-the-difference-between-properties-and-attributes-in-html/6004028#6004028\"\u003eWhat is the difference between properties and attributes in HTML\u003c/a\u003e看看原文\u003c/p\u003e\n\u003cp\u003e既然\u003ccode\u003eproperty\u003c/code\u003e是对象上的一个属性，那个肯定也可以给它赋一个对象类型的值！接下来就使用\u003ccode\u003eproperty\u003c/code\u003e来重构\u003ccode\u003eReply\u003c/code\u003e组件\u003c/p\u003e\n\n      \u003ch2\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003e使用 property 重构组件\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h2\u003e\n    \u003cp\u003e其实修改起来非常方便，代码改动还是比较少的\u003c/p\u003e\n\u003cp\u003e首先是最下面给组件更新值的代码需要变动：不再使用\u003ccode\u003esetAttribute\u003c/code\u003e，而是直接设置\u003ccode\u003ecomments\u003c/code\u003e属性\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003ereply.\u003cspan class=\"hljs-title function_\"\u003esetAttribute\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;comments\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003estringify\u003c/span\u003e(comments));\n\n\u003cspan class=\"hljs-comment\"\u003e// 修改为 ⬇️\u003c/span\u003e\n\nreply.\u003cspan class=\"hljs-property\"\u003ecomments\u003c/span\u003e = comments;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其次，我们需要一对\u003ccode\u003egetter\u003c/code\u003e和\u003ccode\u003esetter\u003c/code\u003e来监听数据变化从而渲染新的值\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReply\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title class_ inherited__\"\u003eHTMLElement\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// 在这里，我们使用_comments来保存comments数据\u003c/span\u003e\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e_comments\u003c/span\u003e = [];\n  }\n  \u003cspan class=\"hljs-keyword\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecomments\u003c/span\u003e() {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e_comments\u003c/span\u003e;\n  }\n\n  \u003cspan class=\"hljs-keyword\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecomments\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003enewValue\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e_comments\u003c/span\u003e = newValue;\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003erenderComments\u003c/span\u003e(newValue);\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e同时，删除监听\u003ccode\u003ecomments\u003c/code\u003e属性相关的代码，因为我们这个已经通过\u003ccode\u003esetter\u003c/code\u003e实现数据监听了\u003c/p\u003e\n\u003cp\u003e到这里，我们已经完成重构，实现组件的原本功能了\u003c/p\u003e\n\u003cp\u003e不过我们要更新一步！\u003c/p\u003e\n\u003cp\u003e既然我们都能传递数组进去了，那么在大胆点，可不可以传递一个函数呢？\u003c/p\u003e\n\u003cp\u003e当然可以！！！\u003c/p\u003e\n\u003cp\u003e我们可以直接在\u003ccode\u003ereply\u003c/code\u003e上挂载一个\u003ccode\u003eonSubmitComment\u003c/code\u003e函数，在\u003ccode\u003eReply\u003c/code\u003e内部按钮点击时调用该回调，并将数据传递出来\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 直接在组件实例上挂载一个回调函数\u003c/span\u003e\nreply.\u003cspan class=\"hljs-property\"\u003eonSubmitComment\u003c/span\u003e = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ee\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n  comments.\u003cspan class=\"hljs-title function_\"\u003epush\u003c/span\u003e({\n    \u003cspan class=\"hljs-attr\"\u003ecomment\u003c/span\u003e: e,\n    nickName,\n    avatar,\n  });\n  reply.\u003cspan class=\"hljs-property\"\u003ecomments\u003c/span\u003e = comments;\n};\n\n\u003cspan class=\"hljs-comment\"\u003e// 组件内部，点击按钮时调用该函数\u003c/span\u003e\nsubmitBtn.\u003cspan class=\"hljs-title function_\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;click\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eonSubmitComment\u003c/span\u003e?.(commentInput.\u003cspan class=\"hljs-property\"\u003evalue\u003c/span\u003e);\n  commentInput.\u003cspan class=\"hljs-property\"\u003evalue\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e;\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e芜湖～ 🎉\u003c/p\u003e\n\u003cp\u003e完整代码\u003ca href=\"https://github.com/mrrs878/web-components/blob/main/reply-property.html\"\u003e在这里\u003c/a\u003e\u003c/p\u003e\n\n      \u003ch2\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003e总结\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h2\u003e\n    \u003cp\u003e\u003ccode\u003eattribute\u003c/code\u003e只能传递字符串数据，\u003ccode\u003eproperty\u003c/code\u003e由于是 DOM 对象上的属性，因此可以传递诸如对象、函数等复杂类型的数据。\u003c/p\u003e\n\u003cp\u003e据此，我们可以使用\u003ccode\u003eproperty\u003c/code\u003e来将数据直接设置到组件实例上，组件内部新增一对\u003ccode\u003egetter\u003c/code\u003e和\u003ccode\u003esetter\u003c/code\u003e来接收数据，而且我们还可以直接在组件实例上挂载一个回调函数，在组件内部可以直接调用该回调。\u003c/p\u003e\n\u003cp\u003e此外在处理类似于\u003ccode\u003edisable\u003c/code\u003e这种类型的\u003ccode\u003eattribute\u003c/code\u003e时也可以使用\u003ccode\u003eproperty\u003c/code\u003e+\u003ccode\u003egetter\u003c/code\u003e和\u003ccode\u003esetter\u003c/code\u003e来实现布尔类型属性的设置\u003c/p\u003e\n\u003cp\u003e总之，\u003ccode\u003eattribute\u003c/code\u003e和\u003ccode\u003eproperty\u003c/code\u003e搭配使用将极大提高开发效率\u003c/p\u003e\n\n      \u003ch2\u003e\n        \u003cspan class=\"prefix\"\u003e\u003c/span\u003e\n        \u003cspan class=\"content\"\u003e参考\u003c/span\u003e\n        \u003cspan class=\"suffix\"\u003e\u003c/span\u003e\n      \u003c/h2\u003e\n    \u003cp\u003e\u003ca href=\"https://stackoverflow.com/questions/6003819/what-is-the-difference-between-properties-and-attributes-in-html/6004028#6004028\"\u003eWhat is the difference between properties and attributes in HTML\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://itnext.io/handling-data-with-web-components-9e7e4a452e6e\"\u003e# Handling data with Web Components\u003c/a\u003e\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/post/[title]","query":{"title":"Web Component-处理数据"},"buildId":"CZ6Uu2i9da2HCumDfSdj1","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>