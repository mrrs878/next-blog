<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Mr.RSçš„ä¸ªäººåšå®¢-å‰ç«¯æ¶æ„&amp;è½¯å®åŠ›-é¢„åŠ è½½&amp;æ‡’åŠ è½½</title><meta name="next-head-count" content="3"/><link rel="preload" href="/next-blog/_next/static/css/1bf96eec8dc413e7.css" as="style"/><link rel="stylesheet" href="/next-blog/_next/static/css/1bf96eec8dc413e7.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/next-blog/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/next-blog/_next/static/chunks/webpack-cf185e4b59cdddcf.js" defer=""></script><script src="/next-blog/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/next-blog/_next/static/chunks/main-1c9e93b8392c1bc9.js" defer=""></script><script src="/next-blog/_next/static/chunks/pages/_app-ca6aae25bc99a05f.js" defer=""></script><script src="/next-blog/_next/static/chunks/899-1cd3a59abdb8ea18.js" defer=""></script><script src="/next-blog/_next/static/chunks/pages/post/%5Btitle%5D-406bad804ceffd1d.js" defer=""></script><script src="/next-blog/_next/static/VEO_ERUabz6t4SXdQFN9R/_buildManifest.js" defer=""></script><script src="/next-blog/_next/static/VEO_ERUabz6t4SXdQFN9R/_ssgManifest.js" defer=""></script><script src="/next-blog/_next/static/VEO_ERUabz6t4SXdQFN9R/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><header class="fixed top-0 py-4 left-0 right-0 h-auto px-10 shadow bg-white z-50"><nav><ul class="flex w-auto"><li class="mr-4 hover:text-yellow"><a href="/next-blog">é¦–é¡µ</a></li><li class="mx-4 hover:text-yellow"><a href="/next-blog/categories">åˆ†ç±»</a></li><li class="mx-4 hover:text-yellow"><a href="/next-blog/tags">æ ‡ç­¾</a></li><li class="ml-4 hover:text-yellow"><a href="/next-blog/timeline">å½’æ¡£</a></li></ul></nav></header><main class="mt-20 mb-4 mx-auto justify-center w-2/3"><div class="mx-auto lg:max-w-5xl md:max-w-3xl"><article class="flex flex-col justify-around pb-16 px-4 mx-auto space-y-10 text-base"><div class="flex flex-col space-y-4"><h1 class="inline pt-10 text-4xl text-skin-primary">å‰ç«¯æ¶æ„&amp;è½¯å®åŠ›-é¢„åŠ è½½&amp;æ‡’åŠ è½½</h1><div class="text-sm space-x-2 text-skin-muted"><span><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>2020-04-24 21:17:04</span><span><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>44</span></div></div><div class="mt-8 flex"><div class="w-full flex-auto custom-markdown-body"><div class="markdown-body" id="write"><h1 id="é¢„åŠ è½½">é¢„åŠ è½½</h1>
<h2 id="å®ç°æ€è·¯">å®ç°æ€è·¯</h2>
<p><code>new</code>ä¸€ä¸ªæ–°çš„<code>Imgnode</code>ï¼Œç»™<code>Imgnode</code>çš„<code>src</code>èµ‹å€¼ä¸ºçœŸæ­£çš„<code>src</code>ï¼›è¯¥<code>Imgnode</code>åœ¨åŠ è½½å®Œæ¯•åç›¸åº”çš„å›¾ç‰‡èµ„æºå°±ä¼šåœ¨æœ¬åœ°ç¼“å­˜ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span>  <span class="hljs-title function_">preLoad</span> (...src) {
    src.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span>  =&gt;</span> {
        <span class="hljs-keyword">const</span>  imgNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>()
        imgNode.<span class="hljs-property">src</span> = realSrc
    })
}
</code></pre>
<h1 id="æ‡’åŠ è½½">æ‡’åŠ è½½</h1>
<h2 id="å®ç°æ€è·¯-1">å®ç°æ€è·¯</h2>
<p>é¦–å…ˆè®¾ç½®ä¸€ä¸ªä¸´æ—¶å±æ€§ <code>data-src</code>ï¼Œå½“å‰å…ƒç´ æ˜¯å¦å‡ºç°åœ¨è§†å£æ—¶ä½¿ç”¨ <code>src</code> ä»£æ›¿ <code>data-src</code>ã€‚</p>
<ol>
<li><p><code>window.onscroll</code> + <code>clientTop</code>ï¼Œ<code>offsetTop</code>ï¼Œ<code>clientHeight</code> <code>scrollTop</code> + èŠ‚æµ ğŸ‘</p>
<p>ä¸å®¹æ˜“åˆ¤æ–­å…ƒç´ çš„ä½ç½®</p>
</li>
<li><p><code>window.onscroll</code> + <code>Element.getBoundingClientRect()</code> + èŠ‚æµğŸ‘</p>
<p><code>getBoundingClientRect</code>ä¼šè§¦å‘å›æµ</p>
</li>
<li><p><code>IntersectionObserver</code>ğŸ‘</p>
<pre><code class="hljs language-js">&lt;img  style=<span class="hljs-string">&quot;width: 200px;&quot;</span>  id=<span class="hljs-string">&quot;img&quot;</span>  data-src=<span class="hljs-string">&quot;./assets/yoda.jpg&quot;</span>  alt=<span class="hljs-string">&quot;&quot;</span>  srcset=<span class="hljs-string">&quot;&quot;</span>&gt;

<span class="hljs-keyword">const</span>  observer = <span class="hljs-keyword">new</span>  <span class="hljs-title class_">IntersectionObserver</span>(<span class="hljs-function"><span class="hljs-params">changes</span>=&gt;</span> {
    changes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">change</span>  =&gt;</span> {
        <span class="hljs-comment">// change.isIntersecting åˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦å‡ºç°åœ¨è§†å£ä¸­</span>
        <span class="hljs-keyword">if</span> (change.<span class="hljs-property">isIntersecting</span>) {
            <span class="hljs-keyword">const</span>  img = change.<span class="hljs-property">target</span>
            img.<span class="hljs-property">src</span> = img.<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span>
            <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">deleteProperty</span>(img.<span class="hljs-property">dataset</span>, <span class="hljs-string">&quot;src&quot;</span>)
            observer.<span class="hljs-title function_">unobserve</span>(img)
        }
    })
})
observer.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#img&quot;</span>))
</code></pre>
</li>
<li><p><code>img</code>çš„<code>lazy</code>å±æ€§ ğŸ‘</p>
<p>å…¼å®¹æ€§å·®ï¼Œ<a href="https://www.jianguoyun.com/static/stackedit/%5Bhttps://www.zhangxinxu.com/wordpress/2019/09/native-img-loading-lazy/%5D(https://www.zhangxinxu.com/wordpress/2019/09/native-img-loading-lazy/)">å…·ä½“å®è·µ</a></p>
<p><code>&lt;img loading=&quot;lazy&quot; src=&quot;http://blog.p18c.top/imgs/avatar.png&quot; alt=&quot;&quot; srcset=&quot;&quot;&gt;</code></p>
</li>
</ol>
<h1 id="é¢„åŠ è½½-vs-æ‡’åŠ è½½">é¢„åŠ è½½ VS æ‡’åŠ è½½</h1>
<p>|      | é¢„åŠ è½½                             | æ‡’åŠ è½½                                      |
| </p>
</div></div></div></article></div></main><footer class="flex flex-col items-center justify-center leading-8 text-sm w-full py-2 border-t text-skin-muted"><p>Designed &amp; developed by<a class="ml-1 text-yellow" target="_blank" href="https://github.com/mrrs878" rel="noreferrer">Mr.RS</a></p><p>Â©<!-- --> <!-- -->2022</p></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"å‰ç«¯æ¶æ„\u0026è½¯å®åŠ›-é¢„åŠ è½½\u0026æ‡’åŠ è½½","tags":["é¢„åŠ è½½\u0026æ‡’åŠ è½½"],"categories":"å‰ç«¯æ¶æ„\u0026è½¯å®åŠ›","description":"# é¢„åŠ è½½\n\n## å®ç°æ€è·¯\n\n`new`ä¸€ä¸ªæ–°çš„`Imgnode`ï¼Œç»™`Imgnode`çš„`src`èµ‹å€¼ä¸ºçœŸæ­£çš„`src`ï¼›è¯¥`Imgnode`åœ¨åŠ è½½å®Œæ¯•åç›¸åº”çš„å›¾ç‰‡èµ„æºå°±ä¼šåœ¨æœ¬åœ°ç¼“å­˜ã€‚\n\n```js\nfunction  preLoad (...src) {\n\tsrc.forEach(item  =\u003e {\n\t\tconst  imgNode = new Image()\n\t\timgNode.sr","createDate":"2020-04-24 21:17:04","updateDate":"2021-02-20 17:16:23","body":"\u003ch1 id=\"é¢„åŠ è½½\"\u003eé¢„åŠ è½½\u003c/h1\u003e\n\u003ch2 id=\"å®ç°æ€è·¯\"\u003eå®ç°æ€è·¯\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003enew\u003c/code\u003eä¸€ä¸ªæ–°çš„\u003ccode\u003eImgnode\u003c/code\u003eï¼Œç»™\u003ccode\u003eImgnode\u003c/code\u003eçš„\u003ccode\u003esrc\u003c/code\u003eèµ‹å€¼ä¸ºçœŸæ­£çš„\u003ccode\u003esrc\u003c/code\u003eï¼›è¯¥\u003ccode\u003eImgnode\u003c/code\u003eåœ¨åŠ è½½å®Œæ¯•åç›¸åº”çš„å›¾ç‰‡èµ„æºå°±ä¼šåœ¨æœ¬åœ°ç¼“å­˜ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e  \u003cspan class=\"hljs-title function_\"\u003epreLoad\u003c/span\u003e (...src) {\n    src.\u003cspan class=\"hljs-title function_\"\u003eforEach\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eitem\u003c/span\u003e  =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e  imgNode = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eImage\u003c/span\u003e()\n        imgNode.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e = realSrc\n    })\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1 id=\"æ‡’åŠ è½½\"\u003eæ‡’åŠ è½½\u003c/h1\u003e\n\u003ch2 id=\"å®ç°æ€è·¯-1\"\u003eå®ç°æ€è·¯\u003c/h2\u003e\n\u003cp\u003eé¦–å…ˆè®¾ç½®ä¸€ä¸ªä¸´æ—¶å±æ€§ \u003ccode\u003edata-src\u003c/code\u003eï¼Œå½“å‰å…ƒç´ æ˜¯å¦å‡ºç°åœ¨è§†å£æ—¶ä½¿ç”¨ \u003ccode\u003esrc\u003c/code\u003e ä»£æ›¿ \u003ccode\u003edata-src\u003c/code\u003eã€‚\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003ewindow.onscroll\u003c/code\u003e + \u003ccode\u003eclientTop\u003c/code\u003eï¼Œ\u003ccode\u003eoffsetTop\u003c/code\u003eï¼Œ\u003ccode\u003eclientHeight\u003c/code\u003e \u003ccode\u003escrollTop\u003c/code\u003e + èŠ‚æµ ğŸ‘\u003c/p\u003e\n\u003cp\u003eä¸å®¹æ˜“åˆ¤æ–­å…ƒç´ çš„ä½ç½®\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003ewindow.onscroll\u003c/code\u003e + \u003ccode\u003eElement.getBoundingClientRect()\u003c/code\u003e + èŠ‚æµğŸ‘\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003egetBoundingClientRect\u003c/code\u003eä¼šè§¦å‘å›æµ\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eIntersectionObserver\u003c/code\u003eğŸ‘\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u0026lt;img  style=\u003cspan class=\"hljs-string\"\u003e\u0026quot;width: 200px;\u0026quot;\u003c/span\u003e  id=\u003cspan class=\"hljs-string\"\u003e\u0026quot;img\u0026quot;\u003c/span\u003e  data-src=\u003cspan class=\"hljs-string\"\u003e\u0026quot;./assets/yoda.jpg\u0026quot;\u003c/span\u003e  alt=\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e  srcset=\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u0026gt;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e  observer = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e  \u003cspan class=\"hljs-title class_\"\u003eIntersectionObserver\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003echanges\u003c/span\u003e=\u0026gt;\u003c/span\u003e {\n    changes.\u003cspan class=\"hljs-title function_\"\u003eforEach\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003echange\u003c/span\u003e  =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-comment\"\u003e// change.isIntersecting åˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦å‡ºç°åœ¨è§†å£ä¸­\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (change.\u003cspan class=\"hljs-property\"\u003eisIntersecting\u003c/span\u003e) {\n            \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e  img = change.\u003cspan class=\"hljs-property\"\u003etarget\u003c/span\u003e\n            img.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e = img.\u003cspan class=\"hljs-property\"\u003edataset\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003esrc\u003c/span\u003e\n            \u003cspan class=\"hljs-title class_\"\u003eReflect\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003edeleteProperty\u003c/span\u003e(img.\u003cspan class=\"hljs-property\"\u003edataset\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;src\u0026quot;\u003c/span\u003e)\n            observer.\u003cspan class=\"hljs-title function_\"\u003eunobserve\u003c/span\u003e(img)\n        }\n    })\n})\nobserver.\u003cspan class=\"hljs-title function_\"\u003eobserve\u003c/span\u003e(\u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;#img\u0026quot;\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eimg\u003c/code\u003eçš„\u003ccode\u003elazy\u003c/code\u003eå±æ€§ ğŸ‘\u003c/p\u003e\n\u003cp\u003eå…¼å®¹æ€§å·®ï¼Œ\u003ca href=\"https://www.jianguoyun.com/static/stackedit/%5Bhttps://www.zhangxinxu.com/wordpress/2019/09/native-img-loading-lazy/%5D(https://www.zhangxinxu.com/wordpress/2019/09/native-img-loading-lazy/)\"\u003eå…·ä½“å®è·µ\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;img loading=\u0026quot;lazy\u0026quot; src=\u0026quot;http://blog.p18c.top/imgs/avatar.png\u0026quot; alt=\u0026quot;\u0026quot; srcset=\u0026quot;\u0026quot;\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1 id=\"é¢„åŠ è½½-vs-æ‡’åŠ è½½\"\u003eé¢„åŠ è½½ VS æ‡’åŠ è½½\u003c/h1\u003e\n\u003cp\u003e|      | é¢„åŠ è½½                             | æ‡’åŠ è½½                                      |\n| \u003c/p\u003e\n"}},"__N_SSG":true},"page":"/post/[title]","query":{"title":"å‰ç«¯æ¶æ„\u0026è½¯å®åŠ›-é¢„åŠ è½½\u0026æ‡’åŠ è½½"},"buildId":"VEO_ERUabz6t4SXdQFN9R","assetPrefix":"/next-blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>