<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Mr.RS的个人博客-JavaScript相关-4</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/c254d3655a5edcea.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c254d3655a5edcea.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-514908bffb652963.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-1e7421553b9673ee.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9cd1d19dd7237c4c.js" defer=""></script><script src="/_next/static/chunks/443-78ba638de598a708.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Btitle%5D-8e525edef48fb7d5.js" defer=""></script><script src="/_next/static/yzI-MX0bChSNiDL4n6hJE/_buildManifest.js" defer=""></script><script src="/_next/static/yzI-MX0bChSNiDL4n6hJE/_ssgManifest.js" defer=""></script><script src="/_next/static/yzI-MX0bChSNiDL4n6hJE/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><header class="fixed top-0 py-4 left-0 right-0 h-auto px-10 shadow bg-white z-50"><nav><ul class="flex w-auto"><li class="mr-4 hover:text-yellow"><a href="/">首页</a></li><li class="mx-4 hover:text-yellow"><a href="/">分类</a></li><li class="ml-4 hover:text-yellow"><a href="/">归档</a></li></ul></nav></header><main class="mt-20 mb-4 mx-auto justify-center w-2/3"><div class="mx-auto lg:max-w-5xl md:max-w-3xl"><article class="flex flex-col justify-around pb-16 px-4 mx-auto space-y-10 text-base"><div class="flex flex-col space-y-4"><h1 class="inline pt-10 text-4xl text-skin-primary">JavaScript相关-4</h1><div class="text-sm space-x-2 text-skin-muted"><span><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>2020-02-17 22:25:05</span><span><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>44</span></div></div><div class="mt-8 flex"><div class="w-full flex-auto custom-markdown-body"><div class="markdown-body" id="write"><h2 id="模拟实现call、apply">模拟实现call、apply</h2>
<p>实现思路：</p>
<ul>
<li>不传入第一个参数，那么默认为<code>window</code></li>
<li>改变了<code>this</code>指向，让新对象可以执行该函数，那个思路可以变成给新对象添加一个函数，然后在执行完成之后删除</li>
</ul>
<pre><code class="hljs language-javascript"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myCall</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">context</span>) {
  context = context || <span class="hljs-variable language_">window</span>
  context.<span class="hljs-property">fn</span> = <span class="hljs-variable language_">this</span>
  <span class="hljs-keyword">const</span> args = [...<span class="hljs-variable language_">arguments</span>].<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
  <span class="hljs-keyword">const</span> result = context.<span class="hljs-title function_">fn</span>(...args)
  <span class="hljs-keyword">delete</span> context.<span class="hljs-property">fn</span>
  <span class="hljs-keyword">return</span> result
}

<span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myApply</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">context</span>) {
  context = context || <span class="hljs-variable language_">window</span>
  context.<span class="hljs-property">fn</span> = <span class="hljs-variable language_">this</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>] ? context.<span class="hljs-title function_">fn</span>(...<span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>]) : context.<span class="hljs-title function_">fn</span>()
  <span class="hljs-keyword">delete</span> context.<span class="hljs-property">fn</span>
  <span class="hljs-keyword">return</span> result
}

<span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myBind</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">context</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span> !== <span class="hljs-string">&#x27;function&#x27;</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;error&quot;</span>)
  <span class="hljs-keyword">const</span> that = <span class="hljs-variable language_">this</span>
  <span class="hljs-keyword">const</span> args = [...<span class="hljs-variable language_">arguments</span>].<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">F</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span> <span class="hljs-keyword">instanceof</span> F) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">that</span>(...args, ...<span class="hljs-variable language_">arguments</span>)
    }
    <span class="hljs-keyword">return</span> that.<span class="hljs-title function_">apply</span>(context, args.<span class="hljs-title function_">concat</span>(...<span class="hljs-variable language_">arguments</span>))
  }
}

<span class="hljs-keyword">const</span> tom = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;tom&quot;</span>,
  say (tmp1, tmp2) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>, tmp1, tmp2);
  }
}
<span class="hljs-keyword">const</span> jack = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;jack&quot;</span>
}

tom.<span class="hljs-property">say</span>.<span class="hljs-title function_">myCall</span>(jack, <span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>)
tom.<span class="hljs-property">say</span>.<span class="hljs-title function_">call</span>(jack, <span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>)

tom.<span class="hljs-property">say</span>.<span class="hljs-title function_">myApply</span>(jack, [<span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>])
tom.<span class="hljs-property">say</span>.<span class="hljs-title function_">apply</span>(jack, [<span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>])

tom.<span class="hljs-property">say</span>.<span class="hljs-title function_">myBind</span>(jack)(<span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>)
tom.<span class="hljs-property">say</span>.<span class="hljs-title function_">bind</span>(jack)(<span class="hljs-string">&quot;111&quot;</span>, <span class="hljs-string">&quot;222&quot;</span>)

<span class="hljs-comment">// jack 111 222</span>
<span class="hljs-comment">// jack 111 222</span>
<span class="hljs-comment">// jack 111 222</span>
<span class="hljs-comment">// jack 111 222</span>
<span class="hljs-comment">// jack 111 222</span>
<span class="hljs-comment">// jack 111 222</span>
</code></pre>
<h2 id="promise-实现">Promise 实现</h2>
<p><code>Promise</code>是ES6新增的语法，解决了回调地狱的问题。可以把<code>Promise</code>看作是一个状态机，可以通过函数<code>resolve</code>和<code>reject</code>将状态转变为<code>resolved</code>或<code>rejected</code>，状态一旦转变就不能再次变化</p>
<p><code>then</code>函数会返回一个新的<code>Promise</code>实例。因为<code>Promise</code>规范规定除了<code>pending</code>状态，其他状态是不可以改变的，如果返回的是一个相同实例的话，多个<code>then</code>调用就失去意义了</p>
<p>对于<code>then</code>，本质上可以把它看成是<code>flatMap</code></p>
<h2 id="proxy">Proxy</h2>
<p>proxy是ES6中新增的功能，用来定义对象中的操作</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">onwatch</span>(<span class="hljs-params">obj, setBind, getLogger</span>) {
  <span class="hljs-keyword">const</span> handler = {
    <span class="hljs-title function_">get</span>(<span class="hljs-params">target, property, receiver</span>) {
      <span class="hljs-title function_">getLogger</span>(target, property)
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, property, receiver)
    },
    <span class="hljs-title function_">set</span>(<span class="hljs-params">target, property, value</span>) {
      <span class="hljs-title function_">setBind</span>(target, property, value)
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, property, value)
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(obj, handler)
}

<span class="hljs-keyword">let</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }
<span class="hljs-keyword">let</span> p = <span class="hljs-title function_">onwatch</span>(obj, <span class="hljs-function">(<span class="hljs-params">target, property, value</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`set <span class="hljs-subst">${ property }</span> = <span class="hljs-subst">${ value }</span>`</span>);
}, <span class="hljs-function">(<span class="hljs-params">target, property</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`get <span class="hljs-subst">${ property }</span> = <span class="hljs-subst">${ target[property] }</span>`</span>);
})

p.<span class="hljs-property">a</span> = <span class="hljs-number">2</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p.<span class="hljs-property">a</span>);

<span class="hljs-comment">// set a = 2</span>
<span class="hljs-comment">// get a = 2</span>
</code></pre>
<h2 id="正则表达式">正则表达式</h2>
<p><strong>元字符</strong></p>
<p>| 元字符 |             作用             |
| :</p>
</div></div></div></article></div></main><footer class="flex flex-col items-center justify-center leading-8 text-sm w-full py-2 border-t text-skin-muted"><p>Designed &amp; developed by<a class="ml-1 text-yellow" target="_blank" href="https://github.com/mrrs878" rel="noreferrer">Mr.RS</a></p><div class="flex items-center justify-center"><span>本网站由 </span><a class="cdn-logo-c" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral"><img class="call-me" src="https://blog.mrrs.top/img/cdn_logo.png" style="width:40px" alt=""/></a><span>提供CDN加速/云存储服务</span></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"JavaScript相关-4","tags":["JavaScript"],"categories":"JavaScript","description":"## 模拟实现call、apply\n\n实现思路：\n\n- 不传入第一个参数，那么默认为`window`\n- 改变了`this`指向，让新对象可以执行该函数，那个思路可以变成给新对象添加一个函数，然后在执行完成之后删除\n\n``` javascript\nFunction.prototype.myCall = function (context) {\n  context = context || wi","createDate":"2020-02-17 22:25:05","updateDate":"10/1/2021, 3:34:43 AM","body":"\u003ch2 id=\"模拟实现call、apply\"\u003e模拟实现call、apply\u003c/h2\u003e\n\u003cp\u003e实现思路：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e不传入第一个参数，那么默认为\u003ccode\u003ewindow\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e改变了\u003ccode\u003ethis\u003c/code\u003e指向，让新对象可以执行该函数，那个思路可以变成给新对象添加一个函数，然后在执行完成之后删除\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-title class_\"\u003eFunction\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprototype\u003c/span\u003e\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003emyCall\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e (\u003cspan class=\"hljs-params\"\u003econtext\u003c/span\u003e) {\n  context = context || \u003cspan class=\"hljs-variable language_\"\u003ewindow\u003c/span\u003e\n  context.\u003cspan class=\"hljs-property\"\u003efn\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e args = [...\u003cspan class=\"hljs-variable language_\"\u003earguments\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eslice\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e result = context.\u003cspan class=\"hljs-title function_\"\u003efn\u003c/span\u003e(...args)\n  \u003cspan class=\"hljs-keyword\"\u003edelete\u003c/span\u003e context.\u003cspan class=\"hljs-property\"\u003efn\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e result\n}\n\n\u003cspan class=\"hljs-title class_\"\u003eFunction\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprototype\u003c/span\u003e\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003emyApply\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003econtext\u003c/span\u003e) {\n  context = context || \u003cspan class=\"hljs-variable language_\"\u003ewindow\u003c/span\u003e\n  context.\u003cspan class=\"hljs-property\"\u003efn\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e result = \u003cspan class=\"hljs-variable language_\"\u003earguments\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e] ? context.\u003cspan class=\"hljs-title function_\"\u003efn\u003c/span\u003e(...\u003cspan class=\"hljs-variable language_\"\u003earguments\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e]) : context.\u003cspan class=\"hljs-title function_\"\u003efn\u003c/span\u003e()\n  \u003cspan class=\"hljs-keyword\"\u003edelete\u003c/span\u003e context.\u003cspan class=\"hljs-property\"\u003efn\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e result\n}\n\n\u003cspan class=\"hljs-title class_\"\u003eFunction\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprototype\u003c/span\u003e\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003emyBind\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003econtext\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003etypeof\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e !== \u003cspan class=\"hljs-string\"\u003e\u0026#x27;function\u0026#x27;\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003ethrow\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eTypeError\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;error\u0026quot;\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e that = \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e args = [...\u003cspan class=\"hljs-variable language_\"\u003earguments\u003c/span\u003e].\u003cspan class=\"hljs-title function_\"\u003eslice\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eF\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003einstanceof\u003c/span\u003e F) {\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ethat\u003c/span\u003e(...args, ...\u003cspan class=\"hljs-variable language_\"\u003earguments\u003c/span\u003e)\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e that.\u003cspan class=\"hljs-title function_\"\u003eapply\u003c/span\u003e(context, args.\u003cspan class=\"hljs-title function_\"\u003econcat\u003c/span\u003e(...\u003cspan class=\"hljs-variable language_\"\u003earguments\u003c/span\u003e))\n  }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e tom = {\n  \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;tom\u0026quot;\u003c/span\u003e,\n  say (tmp1, tmp2) {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e, tmp1, tmp2);\n  }\n}\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e jack = {\n  \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;jack\u0026quot;\u003c/span\u003e\n}\n\ntom.\u003cspan class=\"hljs-property\"\u003esay\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003emyCall\u003c/span\u003e(jack, \u003cspan class=\"hljs-string\"\u003e\u0026quot;111\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;222\u0026quot;\u003c/span\u003e)\ntom.\u003cspan class=\"hljs-property\"\u003esay\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ecall\u003c/span\u003e(jack, \u003cspan class=\"hljs-string\"\u003e\u0026quot;111\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;222\u0026quot;\u003c/span\u003e)\n\ntom.\u003cspan class=\"hljs-property\"\u003esay\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003emyApply\u003c/span\u003e(jack, [\u003cspan class=\"hljs-string\"\u003e\u0026quot;111\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;222\u0026quot;\u003c/span\u003e])\ntom.\u003cspan class=\"hljs-property\"\u003esay\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eapply\u003c/span\u003e(jack, [\u003cspan class=\"hljs-string\"\u003e\u0026quot;111\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;222\u0026quot;\u003c/span\u003e])\n\ntom.\u003cspan class=\"hljs-property\"\u003esay\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003emyBind\u003c/span\u003e(jack)(\u003cspan class=\"hljs-string\"\u003e\u0026quot;111\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;222\u0026quot;\u003c/span\u003e)\ntom.\u003cspan class=\"hljs-property\"\u003esay\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ebind\u003c/span\u003e(jack)(\u003cspan class=\"hljs-string\"\u003e\u0026quot;111\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;222\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// jack 111 222\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// jack 111 222\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// jack 111 222\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// jack 111 222\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// jack 111 222\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// jack 111 222\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"promise-实现\"\u003ePromise 实现\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ePromise\u003c/code\u003e是ES6新增的语法，解决了回调地狱的问题。可以把\u003ccode\u003ePromise\u003c/code\u003e看作是一个状态机，可以通过函数\u003ccode\u003eresolve\u003c/code\u003e和\u003ccode\u003ereject\u003c/code\u003e将状态转变为\u003ccode\u003eresolved\u003c/code\u003e或\u003ccode\u003erejected\u003c/code\u003e，状态一旦转变就不能再次变化\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ethen\u003c/code\u003e函数会返回一个新的\u003ccode\u003ePromise\u003c/code\u003e实例。因为\u003ccode\u003ePromise\u003c/code\u003e规范规定除了\u003ccode\u003epending\u003c/code\u003e状态，其他状态是不可以改变的，如果返回的是一个相同实例的话，多个\u003ccode\u003ethen\u003c/code\u003e调用就失去意义了\u003c/p\u003e\n\u003cp\u003e对于\u003ccode\u003ethen\u003c/code\u003e，本质上可以把它看成是\u003ccode\u003eflatMap\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"proxy\"\u003eProxy\u003c/h2\u003e\n\u003cp\u003eproxy是ES6中新增的功能，用来定义对象中的操作\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eonwatch\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eobj, setBind, getLogger\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e handler = {\n    \u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003etarget, property, receiver\u003c/span\u003e) {\n      \u003cspan class=\"hljs-title function_\"\u003egetLogger\u003c/span\u003e(target, property)\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReflect\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eget\u003c/span\u003e(target, property, receiver)\n    },\n    \u003cspan class=\"hljs-title function_\"\u003eset\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003etarget, property, value\u003c/span\u003e) {\n      \u003cspan class=\"hljs-title function_\"\u003esetBind\u003c/span\u003e(target, property, value)\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReflect\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eset\u003c/span\u003e(target, property, value)\n    }\n  }\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eProxy\u003c/span\u003e(obj, handler)\n}\n\n\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e obj = { \u003cspan class=\"hljs-attr\"\u003ea\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e }\n\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e p = \u003cspan class=\"hljs-title function_\"\u003eonwatch\u003c/span\u003e(obj, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003etarget, property, value\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`set \u003cspan class=\"hljs-subst\"\u003e${ property }\u003c/span\u003e = \u003cspan class=\"hljs-subst\"\u003e${ value }\u003c/span\u003e`\u003c/span\u003e);\n}, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003etarget, property\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`get \u003cspan class=\"hljs-subst\"\u003e${ property }\u003c/span\u003e = \u003cspan class=\"hljs-subst\"\u003e${ target[property] }\u003c/span\u003e`\u003c/span\u003e);\n})\n\np.\u003cspan class=\"hljs-property\"\u003ea\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(p.\u003cspan class=\"hljs-property\"\u003ea\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// set a = 2\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// get a = 2\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"正则表达式\"\u003e正则表达式\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003e元字符\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e| 元字符 |             作用             |\n| :\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/post/[title]","query":{"title":"JavaScript相关-4"},"buildId":"yzI-MX0bChSNiDL4n6hJE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>