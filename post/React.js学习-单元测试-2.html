<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Mr.RS的个人博客-React.js学习-单元测试-2</title><meta name="next-head-count" content="3"/><link rel="preload" href="/next-blog/_next/static/css/1bf96eec8dc413e7.css" as="style"/><link rel="stylesheet" href="/next-blog/_next/static/css/1bf96eec8dc413e7.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/next-blog/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/next-blog/_next/static/chunks/webpack-cf185e4b59cdddcf.js" defer=""></script><script src="/next-blog/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/next-blog/_next/static/chunks/main-1c9e93b8392c1bc9.js" defer=""></script><script src="/next-blog/_next/static/chunks/pages/_app-ca6aae25bc99a05f.js" defer=""></script><script src="/next-blog/_next/static/chunks/899-1cd3a59abdb8ea18.js" defer=""></script><script src="/next-blog/_next/static/chunks/pages/post/%5Btitle%5D-406bad804ceffd1d.js" defer=""></script><script src="/next-blog/_next/static/ppbuy0Y8ZmHxlPJAAgrU4/_buildManifest.js" defer=""></script><script src="/next-blog/_next/static/ppbuy0Y8ZmHxlPJAAgrU4/_ssgManifest.js" defer=""></script><script src="/next-blog/_next/static/ppbuy0Y8ZmHxlPJAAgrU4/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><header class="fixed top-0 py-4 left-0 right-0 h-auto px-10 shadow bg-white z-50"><nav><ul class="flex w-auto"><li class="mr-4 hover:text-yellow"><a href="/next-blog">首页</a></li><li class="mx-4 hover:text-yellow"><a href="/next-blog/categories">分类</a></li><li class="mx-4 hover:text-yellow"><a href="/next-blog/tags">标签</a></li><li class="ml-4 hover:text-yellow"><a href="/next-blog/timeline">归档</a></li></ul></nav></header><main class="mt-20 mb-4 mx-auto justify-center w-2/3"><div class="mx-auto lg:max-w-5xl md:max-w-3xl"><article class="flex flex-col justify-around pb-16 px-4 mx-auto space-y-10 text-base"><div class="flex flex-col space-y-4"><h1 class="inline pt-10 text-4xl text-skin-primary">React.js学习-单元测试-2</h1><div class="text-sm space-x-2 text-skin-muted"><span><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>2021-08-30 13:33:10</span><span><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>44</span></div></div><div class="mt-8 flex"><div class="w-full flex-auto custom-markdown-body"><div class="markdown-body" id="write"><p><a href="https://blog.mrrs.top/blog/view/5fcf500be531783853b2fc5c">React.js学习-单元测试-1</a></p>
<p><a href="https://codesandbox.io/s/beautiful-mcclintock-8iqp8">示例代码仓库</a></p>
<p>React.js + Typescript + Jest + @testing-library</p>
<h2 id="安装和配置">安装和配置</h2>
<h3 id="安装">安装</h3>
<p>需要以下库</p>
<ul>
<li><code>jest</code>, 自动化测试框架</li>
<li><code>ts-jest</code>，添加对<code>typescript</code>的支持</li>
<li><code>@testing-library/jest-dom</code>，添加了一些额外的匹配器，测试dom</li>
<li><code>@testing-library/react</code>，测试react组件</li>
<li><code>@testing-library/react-hooks</code>，测试自定义hooks</li>
<li><code>Babel</code>，转译jsx与ESM</li>
</ul>
<pre><code class="hljs language-shell">yarn add jest @testing-library/jest-dom @testing-library/react @testing-library/react-hooks ts-jest -D
</code></pre>
<h3 id="配置">配置</h3>
<p>添加<code>jest</code>配置文件</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// jest.config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">preset</span>: <span class="hljs-string">&#x27;ts-jest&#x27;</span>,
  <span class="hljs-attr">testEnvironment</span>: <span class="hljs-string">&#x27;jsdom&#x27;</span>,
  <span class="hljs-attr">transform</span>: {
    <span class="hljs-string">&#x27;^.+\\.js$&#x27;</span>: <span class="hljs-string">&#x27;babel-jest&#x27;</span>,
    <span class="hljs-string">&#x27;^.+\\.(ts|tsx)$&#x27;</span>: <span class="hljs-string">&#x27;ts-jest&#x27;</span>,
  },
  <span class="hljs-attr">moduleFileExtensions</span>: [<span class="hljs-string">&#x27;js&#x27;</span>, <span class="hljs-string">&#x27;jsx&#x27;</span>, <span class="hljs-string">&#x27;ts&#x27;</span>, <span class="hljs-string">&#x27;tsx&#x27;</span>],
  <span class="hljs-attr">setupFilesAfterEnv</span>: [
    <span class="hljs-string">&#x27;&lt;rootDir&gt;/setupTests.js&#x27;</span>,
  ],
};

<span class="hljs-comment">// setupTests.js</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;@testing-library/jest-dom&#x27;</span>;
</code></pre>
<p><code>ts</code>编译配置文件要有以下配置</p>
<pre><code class="hljs language-json"><span class="hljs-comment">// tsconfig.json</span>
<span class="hljs-comment">// ...</span>
<span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;jsx&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;lib&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">&quot;dom&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">&quot;dom.iterable&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">&quot;esnext&quot;</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;esModuleInterop&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;allowSyntheticDefaultImports&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span>
<span class="hljs-punctuation">}</span>
<span class="hljs-comment">// ...</span>
</code></pre>
<h2 id="jest简要教程">Jest简要教程</h2>
<p><code>describe</code>用来包含一块测试的代码，通常用它来对几个测试进行分组</p>
<p><code>test</code>是每一个测试，内部包含需要测试的方法，别名为<code>it</code></p>
<p><code>expect</code>翻译为预期，需要和很多匹配器结合使用</p>
<pre><code class="hljs language-ts"><span class="hljs-title function_">describe</span>(<span class="hljs-string">&#x27;test useCookie&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;should be defined&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">expect</span>(useCookie).<span class="hljs-title function_">toBeDefined</span>();
  });
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<h2 id="常见dom测试用例">常见DOM测试用例</h2>
<h3 id="测试按钮点击事件">测试按钮点击事件</h3>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { render, fireEvent } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@testing-library/react&quot;</span>;

<span class="hljs-title function_">describe</span>(<span class="hljs-string">&quot;click events&quot;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> onClick = jest.<span class="hljs-title function_">fn</span>();

    <span class="hljs-keyword">const</span> { getByLabelText } = <span class="hljs-title function_">render</span>(
      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">&quot;Button&quot;</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span> /&gt;</span></span>
    );

    <span class="hljs-keyword">const</span> btn = <span class="hljs-title function_">getByLabelText</span>(<span class="hljs-string">&quot;Button&quot;</span>);
    fireEvent.<span class="hljs-title function_">click</span>(btn);
    <span class="hljs-title function_">expect</span>(onClick).<span class="hljs-title function_">toBeCalled</span>();
    <span class="hljs-title function_">expect</span>(onClick).<span class="hljs-title function_">toBeCalledTimes</span>(<span class="hljs-number">1</span>);
  });
});
</code></pre>
<h3 id="测试input输入事件">测试input输入事件</h3>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { fireEvent, render } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@testing-library/react&quot;</span>;

<span class="hljs-title function_">describe</span>(<span class="hljs-string">&quot;input element&quot;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> onChange = jest.<span class="hljs-title function_">fn</span>();

  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;change&quot;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> { getByTestId } = <span class="hljs-title function_">render</span>(
      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">data-testid</span>=<span class="hljs-string">&quot;changeInput&quot;</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{onChange}</span> /&gt;</span></span>
    );

    <span class="hljs-keyword">const</span> input = <span class="hljs-title function_">getByTestId</span>(<span class="hljs-string">&quot;changeInput&quot;</span>);
    fireEvent.<span class="hljs-title function_">change</span>(input, { <span class="hljs-attr">target</span>: { <span class="hljs-attr">value</span>: <span class="hljs-string">&quot;hello&quot;</span> } });
    <span class="hljs-title function_">expect</span>(onChange).<span class="hljs-title function_">toBeCalled</span>();
    <span class="hljs-title function_">expect</span>(input).<span class="hljs-title function_">toHaveProperty</span>(<span class="hljs-string">&quot;value&quot;</span>, <span class="hljs-string">&quot;hello&quot;</span>);
  });
});
</code></pre>
<h3 id="测试props">测试props</h3>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@testing-library/react&quot;</span>;

<span class="hljs-title function_">describe</span>(<span class="hljs-string">&quot;props&quot;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params">{ loading }: { loading?: boolean }</span>) =&gt; (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">data-testid</span>=<span class="hljs-string">&quot;span&quot;</span>&gt;</span>{loading ? &quot;loading...&quot; : &quot;hello&quot;}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>
  );

  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;default props&quot;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> { getByTestId } = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>);
    <span class="hljs-keyword">const</span> span = <span class="hljs-title function_">getByTestId</span>(<span class="hljs-string">&quot;span&quot;</span>);
    <span class="hljs-title function_">expect</span>(span).<span class="hljs-title function_">toHaveTextContent</span>(<span class="hljs-string">&quot;hello&quot;</span>);
  });

  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;props change&quot;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> { getByTestId, rerender } = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>);
    <span class="hljs-keyword">const</span> span = <span class="hljs-title function_">getByTestId</span>(<span class="hljs-string">&quot;span&quot;</span>);
    <span class="hljs-title function_">expect</span>(span).<span class="hljs-title function_">toHaveTextContent</span>(<span class="hljs-string">&quot;hello&quot;</span>);
    <span class="hljs-comment">// 通过rerender来模拟props对改变</span>
    <span class="hljs-title function_">rerender</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> <span class="hljs-attr">loading</span>=<span class="hljs-string">{true}</span> /&gt;</span></span>);
    <span class="hljs-title function_">expect</span>(span).<span class="hljs-title function_">toHaveTextContent</span>(<span class="hljs-string">&quot;loading...&quot;</span>);
    <span class="hljs-title function_">rerender</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> <span class="hljs-attr">loading</span>=<span class="hljs-string">{false}</span> /&gt;</span></span>);
    <span class="hljs-title function_">expect</span>(span).<span class="hljs-title function_">toHaveTextContent</span>(<span class="hljs-string">&quot;hello&quot;</span>);
  });
});
</code></pre>
</div></div></div></article></div></main><footer class="flex flex-col items-center justify-center leading-8 text-sm w-full py-2 border-t text-skin-muted"><p>Designed &amp; developed by<a class="ml-1 text-yellow" target="_blank" href="https://github.com/mrrs878" rel="noreferrer">Mr.RS</a></p><p>©<!-- --> <!-- -->2022</p></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"React.js学习-单元测试-2","tags":["单元测试"],"categories":"React.js","description":"[React.js学习-单元测试-1](https://blog.mrrs.top/blog/view/5fcf500be531783853b2fc5c)\n\n[示例代码仓库](https://codesandbox.io/s/beautiful-mcclintock-8iqp8)\n\nReact.js + Typescript + Jest + @testing-library\n\n## 安装和配","createDate":"2021-08-30 13:33:10","updateDate":"2021-09-01 22:01:37","body":"\u003cp\u003e\u003ca href=\"https://blog.mrrs.top/blog/view/5fcf500be531783853b2fc5c\"\u003eReact.js学习-单元测试-1\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://codesandbox.io/s/beautiful-mcclintock-8iqp8\"\u003e示例代码仓库\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eReact.js + Typescript + Jest + @testing-library\u003c/p\u003e\n\u003ch2 id=\"安装和配置\"\u003e安装和配置\u003c/h2\u003e\n\u003ch3 id=\"安装\"\u003e安装\u003c/h3\u003e\n\u003cp\u003e需要以下库\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ejest\u003c/code\u003e, 自动化测试框架\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ets-jest\u003c/code\u003e，添加对\u003ccode\u003etypescript\u003c/code\u003e的支持\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e@testing-library/jest-dom\u003c/code\u003e，添加了一些额外的匹配器，测试dom\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e@testing-library/react\u003c/code\u003e，测试react组件\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e@testing-library/react-hooks\u003c/code\u003e，测试自定义hooks\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eBabel\u003c/code\u003e，转译jsx与ESM\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-shell\"\u003eyarn add jest @testing-library/jest-dom @testing-library/react @testing-library/react-hooks ts-jest -D\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"配置\"\u003e配置\u003c/h3\u003e\n\u003cp\u003e添加\u003ccode\u003ejest\u003c/code\u003e配置文件\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// jest.config.js\u003c/span\u003e\n\u003cspan class=\"hljs-variable language_\"\u003emodule\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eexports\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003epreset\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;ts-jest\u0026#x27;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003etestEnvironment\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;jsdom\u0026#x27;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003etransform\u003c/span\u003e: {\n    \u003cspan class=\"hljs-string\"\u003e\u0026#x27;^.+\\\\.js$\u0026#x27;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;babel-jest\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e\u0026#x27;^.+\\\\.(ts|tsx)$\u0026#x27;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;ts-jest\u0026#x27;\u003c/span\u003e,\n  },\n  \u003cspan class=\"hljs-attr\"\u003emoduleFileExtensions\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;js\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;jsx\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;ts\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;tsx\u0026#x27;\u003c/span\u003e],\n  \u003cspan class=\"hljs-attr\"\u003esetupFilesAfterEnv\u003c/span\u003e: [\n    \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\u0026lt;rootDir\u0026gt;/setupTests.js\u0026#x27;\u003c/span\u003e,\n  ],\n};\n\n\u003cspan class=\"hljs-comment\"\u003e// setupTests.js\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;@testing-library/jest-dom\u0026#x27;\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ets\u003c/code\u003e编译配置文件要有以下配置\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e\u003cspan class=\"hljs-comment\"\u003e// tsconfig.json\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003e\u0026quot;compilerOptions\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;jsx\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;lib\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003e\u0026quot;dom\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003e\u0026quot;dom.iterable\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003e\u0026quot;esnext\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"hljs-punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;esModuleInterop\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;allowSyntheticDefaultImports\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"jest简要教程\"\u003eJest简要教程\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003edescribe\u003c/code\u003e用来包含一块测试的代码，通常用它来对几个测试进行分组\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003etest\u003c/code\u003e是每一个测试，内部包含需要测试的方法，别名为\u003ccode\u003eit\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eexpect\u003c/code\u003e翻译为预期，需要和很多匹配器结合使用\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-title function_\"\u003edescribe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;test useCookie\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003eit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;should be defined\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(useCookie).\u003cspan class=\"hljs-title function_\"\u003etoBeDefined\u003c/span\u003e();\n  });\n  \u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"常见dom测试用例\"\u003e常见DOM测试用例\u003c/h2\u003e\n\u003ch3 id=\"测试按钮点击事件\"\u003e测试按钮点击事件\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { render, fireEvent } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@testing-library/react\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-title function_\"\u003edescribe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;click events\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003eit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;click\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e onClick = jest.\u003cspan class=\"hljs-title function_\"\u003efn\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { getByLabelText } = \u003cspan class=\"hljs-title function_\"\u003erender\u003c/span\u003e(\n      \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003earia-label\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;Button\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{onClick}\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e btn = \u003cspan class=\"hljs-title function_\"\u003egetByLabelText\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Button\u0026quot;\u003c/span\u003e);\n    fireEvent.\u003cspan class=\"hljs-title function_\"\u003eclick\u003c/span\u003e(btn);\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(onClick).\u003cspan class=\"hljs-title function_\"\u003etoBeCalled\u003c/span\u003e();\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(onClick).\u003cspan class=\"hljs-title function_\"\u003etoBeCalledTimes\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e);\n  });\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"测试input输入事件\"\u003e测试input输入事件\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { fireEvent, render } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@testing-library/react\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-title function_\"\u003edescribe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;input element\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e onChange = jest.\u003cspan class=\"hljs-title function_\"\u003efn\u003c/span\u003e();\n\n  \u003cspan class=\"hljs-title function_\"\u003eit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;change\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { getByTestId } = \u003cspan class=\"hljs-title function_\"\u003erender\u003c/span\u003e(\n      \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003einput\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edata-testid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;changeInput\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eonChange\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{onChange}\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e input = \u003cspan class=\"hljs-title function_\"\u003egetByTestId\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;changeInput\u0026quot;\u003c/span\u003e);\n    fireEvent.\u003cspan class=\"hljs-title function_\"\u003echange\u003c/span\u003e(input, { \u003cspan class=\"hljs-attr\"\u003etarget\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;hello\u0026quot;\u003c/span\u003e } });\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(onChange).\u003cspan class=\"hljs-title function_\"\u003etoBeCalled\u003c/span\u003e();\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(input).\u003cspan class=\"hljs-title function_\"\u003etoHaveProperty\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;value\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;hello\u0026quot;\u003c/span\u003e);\n  });\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"测试props\"\u003e测试props\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-jsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { render } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@testing-library/react\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-title function_\"\u003edescribe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;props\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eApp\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e{ loading }: { loading?: boolean }\u003c/span\u003e) =\u0026gt; (\n    \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003espan\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edata-testid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;span\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e{loading ? \u0026quot;loading...\u0026quot; : \u0026quot;hello\u0026quot;}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003espan\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  );\n\n  \u003cspan class=\"hljs-title function_\"\u003eit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;default props\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { getByTestId } = \u003cspan class=\"hljs-title function_\"\u003erender\u003c/span\u003e(\u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eApp\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e span = \u003cspan class=\"hljs-title function_\"\u003egetByTestId\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;span\u0026quot;\u003c/span\u003e);\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(span).\u003cspan class=\"hljs-title function_\"\u003etoHaveTextContent\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;hello\u0026quot;\u003c/span\u003e);\n  });\n\n  \u003cspan class=\"hljs-title function_\"\u003eit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;props change\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { getByTestId, rerender } = \u003cspan class=\"hljs-title function_\"\u003erender\u003c/span\u003e(\u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eApp\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e span = \u003cspan class=\"hljs-title function_\"\u003egetByTestId\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;span\u0026quot;\u003c/span\u003e);\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(span).\u003cspan class=\"hljs-title function_\"\u003etoHaveTextContent\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;hello\u0026quot;\u003c/span\u003e);\n    \u003cspan class=\"hljs-comment\"\u003e// 通过rerender来模拟props对改变\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_\"\u003ererender\u003c/span\u003e(\u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eApp\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eloading\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{true}\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e);\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(span).\u003cspan class=\"hljs-title function_\"\u003etoHaveTextContent\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;loading...\u0026quot;\u003c/span\u003e);\n    \u003cspan class=\"hljs-title function_\"\u003ererender\u003c/span\u003e(\u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eApp\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eloading\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{false}\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e);\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(span).\u003cspan class=\"hljs-title function_\"\u003etoHaveTextContent\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;hello\u0026quot;\u003c/span\u003e);\n  });\n});\n\u003c/code\u003e\u003c/pre\u003e\n"}},"__N_SSG":true},"page":"/post/[title]","query":{"title":"React.js学习-单元测试-2"},"buildId":"ppbuy0Y8ZmHxlPJAAgrU4","assetPrefix":"/next-blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>