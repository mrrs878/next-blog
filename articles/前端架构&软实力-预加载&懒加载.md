---
title: "å‰ç«¯æ¶æ„&è½¯å®åŠ›-é¢„åŠ è½½&æ‡’åŠ è½½"
tags: "é¢„åŠ è½½&æ‡’åŠ è½½"
categories: "å‰ç«¯æ¶æ„&è½¯å®åŠ›"
description: ""
createDate: "2020-04-24 21:17:04"
updateDate: "2021-02-20 17:16:23"
---


# é¢„åŠ è½½

## å®ç°æ€è·¯

`new`ä¸€ä¸ªæ–°çš„`Imgnode`ï¼Œç»™`Imgnode`çš„`src`èµ‹å€¼ä¸ºçœŸæ­£çš„`src`ï¼›è¯¥`Imgnode`åœ¨åŠ è½½å®Œæ¯•åç›¸åº”çš„å›¾ç‰‡èµ„æºå°±ä¼šåœ¨æœ¬åœ°ç¼“å­˜ã€‚

```js
function  preLoad (...src) {
	src.forEach(item  => {
		const  imgNode = new Image()
		imgNode.src = realSrc
	})
}
```

# æ‡’åŠ è½½

## å®ç°æ€è·¯

é¦–å…ˆè®¾ç½®ä¸€ä¸ªä¸´æ—¶å±æ€§ `data-src`ï¼Œå½“å‰å…ƒç´ æ˜¯å¦å‡ºç°åœ¨è§†å£æ—¶ä½¿ç”¨ `src` ä»£æ›¿ `data-src`ã€‚

1. `window.onscroll` + `clientTop`ï¼Œ`offsetTop`ï¼Œ`clientHeight` `scrollTop` + èŠ‚æµ ğŸ‘

   ä¸å®¹æ˜“åˆ¤æ–­å…ƒç´ çš„ä½ç½®

2. `window.onscroll` + `Element.getBoundingClientRect()` + èŠ‚æµğŸ‘

   `getBoundingClientRect`ä¼šè§¦å‘å›æµ

3. `IntersectionObserver`ğŸ‘

   ```js
   <img  style="width: 200px;"  id="img"  data-src="./assets/yoda.jpg"  alt=""  srcset="">
   
   const  observer = new  IntersectionObserver(changes=> {
   	changes.forEach(change  => {
   		// change.isIntersecting åˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦å‡ºç°åœ¨è§†å£ä¸­
   		if (change.isIntersecting) {
   			const  img = change.target
   			img.src = img.dataset.src
   			Reflect.deleteProperty(img.dataset, "src")
   			observer.unobserve(img)
   		}
   	})
   })
   observer.observe(document.querySelector("#img"))
   ```

4. `img`çš„`lazy`å±æ€§ ğŸ‘

   å…¼å®¹æ€§å·®ï¼Œ[å…·ä½“å®è·µ](https://www.jianguoyun.com/static/stackedit/[https://www.zhangxinxu.com/wordpress/2019/09/native-img-loading-lazy/](https://www.zhangxinxu.com/wordpress/2019/09/native-img-loading-lazy/))

   `<img loading="lazy" src="http://blog.p18c.top/imgs/avatar.png" alt="" srcset="">`

# é¢„åŠ è½½ VS æ‡’åŠ è½½

|      | é¢„åŠ è½½                             | æ‡’åŠ è½½                                      |
| 