{"pageProps":{"post":{"title":"HTML相关-script标签中的async和defer","tags":["async","defer"],"categories":"HTML","description":"script标签用于加载脚本与执行脚本，直接使用script脚本的话，浏览器会按照顺序来加载并执行脚本，在脚本加载&执行的过程中，会阻塞后续的DOM渲染。好在script提供了两种方式来解决上述问题，async和defer，这两个属性使得script都不会阻塞DOM的渲染","createDate":"2022-01-24 20:25:33","updateDate":"2022-01-24 22:01:46","body":"<p><code>script</code>标签用于加载脚本与执行脚本，直接使用<code>script</code>脚本的话，浏览器会按照顺序来加载并执行脚本，在脚本加载&amp;执行的过程中，会阻塞后续的<code>DOM</code>渲染</p>\n<p><img src=\"https://mrrsblog.oss-cn-shanghai.aliyuncs.com/defer-0.png\" alt=\"默认script加载顺序\"></p>\n<p>好在<code>script</code>提供了两种方式来解决上述问题，<code>async</code>和<code>defer</code>，这两个属性使得<code>script</code><strong>都不会阻塞DOM的渲染</strong>。\n但既然会存在两个属性，那么就说明，这两个属性之间肯定是有差异的。</p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">defer</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    <p>用来通知浏览器该脚本将在文档完成解析后，触发<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/DOMContentLoaded_event\">DOMContentLoaded</a>事件前执行</p>\n<p>有<code>defer</code>属性的脚本会阻止<code>DOMContentLoaded</code>事件，直到脚本被加载并且解析完成</p>\n<p>如果有多个设置了<code>defer</code>的<code>script</code>标签存在，则会按照顺序执行所有的<code>script</code></p>\n<p><img src=\"https://mrrsblog.oss-cn-shanghai.aliyuncs.com/defer-1.png\" alt=\"defer\"></p>\n<p>虽然<code>script3</code>加载快于<code>script2</code>，但由于<code>defer</code>存在，因此<code>script3</code>只能等<code>script2</code>执行完毕后再执行</p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">async</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    <p>对于普通脚本，如果存在<code>async</code>属性，那么普通脚本会被并行请求，并尽快解析和执行</p>\n<p><img src=\"https://mrrsblog.oss-cn-shanghai.aliyuncs.com/defer-2.png\" alt=\"async\"></p>\n<p><code>script3</code>加载快于<code>script2</code>，因此<code>script3</code>早于<code>script2</code>执行</p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">图示</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    <p><img src=\"https://mrrsblog.oss-cn-shanghai.aliyuncs.com/defer-async.png\" alt=\"defer-async图示\"></p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">推荐的应用场景</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    \n      <h3>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">defer</span>\n        <span class=\"suffix\"></span>\n      </h3>\n    <p>如果你的脚本代码依赖于页面中的DOM元素（文档是否解析完毕），或者被其他脚本文件依赖。\n例：</p>\n<ul>\n<li>评论框</li>\n<li>代码语法高亮</li>\n<li>polyfill.js</li>\n</ul>\n\n      <h3>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">async</span>\n        <span class=\"suffix\"></span>\n      </h3>\n    <p>如果你的脚本并不关心页面中的DOM元素（文档是否解析完毕），并且也不会产生其他脚本需要的数据。\n例：</p>\n<ul>\n<li>百度统计</li>\n</ul>\n<p>如果不太能确定的话，用defer总是会比async稳定。。。</p>\n"}},"__N_SSG":true}