{"pageProps":{"post":{"title":"MySQL高级-函数","tags":["tags"],"categories":"数据库 MySQL","description":"# MySQL高级-函数\n\n@(mysql)[procedure]\n\n## **查看数据库是否支持函数** ：\n``` SQL\nSHOW VARIABLES LIKE '%FUN%';\n```\n- **若为off，则需要开启**\n``` SQL\nSET GLOBAL log_bin_trust_function_creators = TRUE;\n```\n\n### **创建函数的语法** ：\n``","createDate":"2018-11-12 20:12:37","updateDate":"10/1/2021, 3:34:43 AM","body":"\n      <h1>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">MySQL高级-函数</span>\n        <span class=\"suffix\"></span>\n      </h1>\n    <p>@(mysql)[procedure]</p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\"><strong>查看数据库是否支持函数</strong> ：</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    <pre><code class=\"hljs language-SQL\"><span class=\"hljs-keyword\">SHOW</span> VARIABLES <span class=\"hljs-keyword\">LIKE</span> <span class=\"hljs-string\">&#x27;%FUN%&#x27;</span>;\n</code></pre>\n<ul>\n<li><strong>若为off，则需要开启</strong><pre><code class=\"hljs language-SQL\"><span class=\"hljs-keyword\">SET</span> <span class=\"hljs-keyword\">GLOBAL</span> log_bin_trust_function_creators <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">TRUE</span>;\n</code></pre>\n</li>\n</ul>\n\n      <h3>\n        <span class=\"prefix\"></span>\n        <span class=\"content\"><strong>创建函数的语法</strong> ：</span>\n        <span class=\"suffix\"></span>\n      </h3>\n    <pre><code class=\"hljs language-SQL\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">FUNCTION</span> func_name(variable1, variable2 ...)\n<span class=\"hljs-keyword\">RETURNS</span> return_type\n<span class=\"hljs-keyword\">BEGIN</span>\n    ...\n<span class=\"hljs-keyword\">END</span>;\n\nDELIMITER <span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\n<span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">FUNCTION</span> func_add(a <span class=\"hljs-type\">INT</span>, b <span class=\"hljs-type\">INT</span>)\n<span class=\"hljs-keyword\">RETURNS</span> <span class=\"hljs-type\">INT</span>\n<span class=\"hljs-keyword\">BEGIN</span>\n    <span class=\"hljs-keyword\">RETURN</span> a <span class=\"hljs-operator\">+</span> b;\n<span class=\"hljs-keyword\">END</span>;\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\n</code></pre>\n<p><img src=\"http://hellomrrs-imgs.oss-cn-shanghai.aliyuncs.com/18-11-12/68702030.jpg\" alt=\"enter image description here\"></p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\"><strong>函数的管理</strong> ：</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    <ul>\n<li><strong>函数的管理类似于存储过程</strong>\n      <h3>\n        <span class=\"prefix\"></span>\n        <span class=\"content\"><strong>查看函数</strong></span>\n        <span class=\"suffix\"></span>\n      </h3>\n    <pre><code class=\"hljs language-SQL\"><span class=\"hljs-keyword\">SELECT</span> <span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">FROM</span> mysql.proc;\n<span class=\"hljs-keyword\">SHOW</span> <span class=\"hljs-keyword\">FUNCTION</span> STATUS <span class=\"hljs-keyword\">WHERE</span> db <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&#x27;test&#x27;</span>;\n</code></pre>\n<img src=\"http://hellomrrs-imgs.oss-cn-shanghai.aliyuncs.com/18-11-12/68702030.jpg\" alt=\"enter image description here\">\n      <h3>\n        <span class=\"prefix\"></span>\n        <span class=\"content\"><strong>删除函数</strong></span>\n        <span class=\"suffix\"></span>\n      </h3>\n    <pre><code class=\"hljs language-SQL\"><span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">FUNCTION</span> IF <span class=\"hljs-keyword\">EXISTS</span> func_add;\n</code></pre>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">实例：</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    </li>\n</ul>\n<pre><code class=\"hljs language-SQL\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> user_info (id <span class=\"hljs-type\">INT</span> UNSIGNED <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT <span class=\"hljs-keyword\">PRIMARY</span> KEY,\n                        user_name <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">20</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;&#x27;</span>,\n                        user_pwd  <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">20</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;&#x27;</span>\n                        )ENGINE <span class=\"hljs-operator\">=</span> INNODB CHARSET <span class=\"hljs-operator\">=</span> utf8;\n                         \n<span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">FUNCTION</span> func_login(name <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">20</span>), pwd <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">20</span>))\n<span class=\"hljs-keyword\">RETURNS</span> <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">30</span>)\n<span class=\"hljs-keyword\">BEGIN</span>\n    <span class=\"hljs-keyword\">DECLARE</span> cnt <span class=\"hljs-type\">INT</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-number\">0</span>;\n    <span class=\"hljs-keyword\">SELECT</span> <span class=\"hljs-built_in\">count</span>(<span class=\"hljs-operator\">*</span>) <span class=\"hljs-keyword\">INTO</span> cnt <span class=\"hljs-keyword\">FROM</span> user_info <span class=\"hljs-keyword\">WHERE</span> user_name <span class=\"hljs-operator\">=</span> name;\n    IF cnt <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">THEN</span>\n        <span class=\"hljs-keyword\">RETURN</span> <span class=\"hljs-string\">&#x27;user not exists&#x27;</span>;\n    <span class=\"hljs-keyword\">END</span> IF;\n    <span class=\"hljs-keyword\">SELECT</span> <span class=\"hljs-built_in\">count</span>(<span class=\"hljs-operator\">*</span>) <span class=\"hljs-keyword\">INTO</span> cnt <span class=\"hljs-keyword\">FROM</span> user_info <span class=\"hljs-keyword\">WHERE</span> user_name <span class=\"hljs-operator\">=</span> name <span class=\"hljs-keyword\">AND</span> user_pwd <span class=\"hljs-operator\">=</span> pwd;\n    IF cnt <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">THEN</span>\n        <span class=\"hljs-keyword\">RETURN</span> <span class=\"hljs-string\">&#x27;pwd input error&#x27;</span>;\n    <span class=\"hljs-keyword\">ELSE</span>\n        <span class=\"hljs-keyword\">RETURN</span> <span class=\"hljs-string\">&#x27;user login success&#x27;</span>;\n    <span class=\"hljs-keyword\">END</span> IF;\n<span class=\"hljs-keyword\">END</span>;\n<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>\n</code></pre>\n<p><img src=\"http://hellomrrs-imgs.oss-cn-shanghai.aliyuncs.com/18-11-12/35546849.jpg\" alt=\"enter image description here\"></p>\n"}},"__N_SSG":true}