{"pageProps":{"post":{"title":"è®¾è®¡æ¨¡å¼-çŠ¶æ€æ¨¡å¼","tags":["è®¾è®¡æ¨¡å¼","çŠ¶æ€æ¨¡å¼"],"categories":"è®¾è®¡æ¨¡å¼","description":"å­¦ä¹ ä¸€ä¸‹ã€ŒçŠ¶æ€æ¨¡å¼ã€\n\n## ä»ä¸€ä¸ªåœºæ™¯åˆ‡å…¥\n\nğŸ’¡ éœ€æ±‚ï¼šæŒ‰ä¸‹æŒ‰é’®ï¼Œæ ¹æ®å½“å‰çš„çŠ¶æ€ï¼Œç”µç¯ä¼šåˆ‡æ¢åˆ°æ–°çš„çŠ¶æ€ off->on/on->off\n\né’ˆå¯¹äºè¿™ä¸ªå°çš„éœ€æ±‚ï¼Œç¬¬ä¸€æ—¶é—´å¯èƒ½ä¼šå†™ä¸‹è¿™æ®µä»£ç \n\n```ts\nenum State {\n  on,\n  off,\n}\n\nclass Light {\n  state: State;\n\n  constructor() {\n    this.state = St","createDate":"2022-08-27 15:11:28","updateDate":"2022-08-27 16:35:40","body":"<p>å­¦ä¹ ä¸€ä¸‹ã€ŒçŠ¶æ€æ¨¡å¼ã€</p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">ä»ä¸€ä¸ªåœºæ™¯åˆ‡å…¥</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    <p>ğŸ’¡ éœ€æ±‚ï¼šæŒ‰ä¸‹æŒ‰é’®ï¼Œæ ¹æ®å½“å‰çš„çŠ¶æ€ï¼Œç”µç¯ä¼šåˆ‡æ¢åˆ°æ–°çš„çŠ¶æ€ off-&gt;on/on-&gt;off</p>\n<p>é’ˆå¯¹äºè¿™ä¸ªå°çš„éœ€æ±‚ï¼Œç¬¬ä¸€æ—¶é—´å¯èƒ½ä¼šå†™ä¸‹è¿™æ®µä»£ç </p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-built_in\">enum</span> <span class=\"hljs-title class_\">State</span> {\n  on,\n  off,\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Light</span> {\n  <span class=\"hljs-attr\">state</span>: <span class=\"hljs-title class_\">State</span>;\n\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> = <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">off</span>;\n  }\n\n  <span class=\"hljs-title function_\">press</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> === <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">on</span>) {\n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> = <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">off</span>;\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> === <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">off</span>) {\n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> = <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">on</span>;\n    }\n  }\n}\n</code></pre>\n<p>æµ‹è¯•ä¸€ä¸‹</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-keyword\">const</span> light = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Light</span>();\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">assert</span>(light.<span class=\"hljs-property\">state</span> === <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">off</span>);\n\nlight.<span class=\"hljs-title function_\">press</span>();\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">assert</span>(light.<span class=\"hljs-property\">state</span> === <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">on</span>);\n\nlight.<span class=\"hljs-title function_\">press</span>();\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">assert</span>(light.<span class=\"hljs-property\">state</span> === <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">off</span>);\n</code></pre>\n<p>çœ‹èµ·æ¥å®ç°äº†åŠŸèƒ½ï¼Œä½†å…¶å®æ˜¯å­˜åœ¨ä¸€äº›éšæ‚£ï¼ˆç¼ºé™·ï¼‰çš„ï¼šä¸€æ®µæ—¶é—´åï¼Œéœ€æ±‚å˜äº†ï¼Œç”µç¯å¢åŠ äº†ä¸€ç§çŠ¶æ€--å¼ºå…‰ï¼šåœ¨å…³é—­çš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸€æ¬¡æ‰“å¼€æ˜¯æ­£å¸¸å…‰ï¼Œå†æŒ‰ä¸€ä¸‹ä¼šåˆ‡æ¢åˆ°å¼ºå…‰ï¼Œå†æŒ‰ä¸€ä¸‹æ‰æ˜¯å…³é—­ã€‚é’ˆå¯¹äºè¿™ä¸ªå˜åŠ¨ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä»£ç ç¨ä½œæ”¹åŠ¨ä¹Ÿèƒ½å¤„ç†ï¼š</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-comment\">// ...</span>\n<span class=\"hljs-title function_\">press</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> === <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">off</span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> = <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">on</span>;\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> === <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">on</span>) {\n    <span class=\"hljs-comment\">// æ‰“å¼€çš„æƒ…å†µä¸‹å†æ¬¡æŒ‰ä¸‹ä¼šåˆ‡æ¢åˆ°å¼ºå…‰</span>\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> = <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">superLight</span>;\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> === <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">superLight</span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> = <span class=\"hljs-title class_\">State</span>.<span class=\"hljs-property\">off</span>;\n  }\n}\n<span class=\"hljs-comment\">// ...</span>\n</code></pre>\n<p>ä½†è¿™ä»…ä»…æ˜¯å¢åŠ äº†ä¸€ç§çŠ¶æ€ï¼Œé‚£å¦‚æœä»¥åå†æ·»åŠ ä¸€ç§å¼±å…‰ï¼Œå¼ºå¼ºå…‰ã€‚ã€‚ã€‚é‚£éƒ½è¦å»ä¿®æ”¹ <code>press</code> æ–¹æ³•ï¼Œä¸€æ¥è¯¥å‡½æ•°å°†ä¼šå˜å¾—æå…¶è‡ƒè‚¿ï¼›å†è€…ï¼Œè¯¥è®¾è®¡ä¹Ÿè¿åäº†å¼€é—­åŸåˆ™ï¼šæ¯æ¬¡æ–°å¢æˆ–ä¿®æ”¹ light çš„çŠ¶æ€ï¼Œéƒ½éœ€è¦ä¿®æ”¹ <code>press</code> æ–¹æ³•ï¼Œè¿™ä½¿å¾—è¯¥å‡½æ•°éå¸¸ä¸ç¨³å®šï¼Œéš¾ä»¥ç»´æŠ¤</p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">ä½¿ç”¨çŠ¶æ€æ¨¡å¼æ”¹è¿› ğŸ’¡ ç¨‹åº</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    <p><strong>çŠ¶æ€æ¨¡å¼çš„å…³é”®æ˜¯æŠŠäº‹ç‰©çš„æ¯ç§çŠ¶æ€éƒ½å°è£…æˆå•ç‹¬çš„ç±»ï¼Œè·Ÿæ­¤ç§çŠ¶æ€æœ‰å…³çš„è¡Œä¸ºéƒ½è¢«å°è£…åœ¨è¿™ä¸ªç±»çš„å†…éƒ¨</strong></p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">State</span> {\n  <span class=\"hljs-attr\">light</span>: <span class=\"hljs-title class_\">Light</span>;\n\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\">light: Light</span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">light</span> = light;\n  }\n\n  <span class=\"hljs-title function_\">press</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">&quot;pressæ–¹æ³•å¿…é¡»è¢«é‡å†™&quot;</span>);\n  }\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">OffLightState</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">State</span> {\n  <span class=\"hljs-attr\">light</span>: <span class=\"hljs-title class_\">Light</span>;\n\n  <span class=\"hljs-title function_\">press</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;on&quot;</span>);\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">light</span>.<span class=\"hljs-title function_\">setState</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">light</span>.<span class=\"hljs-property\">onLightState</span>);\n  }\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">OnLightState</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">State</span> {\n  <span class=\"hljs-attr\">light</span>: <span class=\"hljs-title class_\">Light</span>;\n\n  <span class=\"hljs-title function_\">press</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;superLight&quot;</span>);\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">light</span>.<span class=\"hljs-title function_\">setState</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">light</span>.<span class=\"hljs-property\">superLightState</span>);\n  }\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SuperLightState</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">State</span> {\n  <span class=\"hljs-attr\">light</span>: <span class=\"hljs-title class_\">Light</span>;\n\n  <span class=\"hljs-title function_\">press</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;off&quot;</span>);\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">light</span>.<span class=\"hljs-title function_\">setState</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">light</span>.<span class=\"hljs-property\">offLightState</span>);\n  }\n}\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Light</span> {\n  <span class=\"hljs-attr\">state</span>: <span class=\"hljs-title class_\">State</span>;\n\n  <span class=\"hljs-attr\">offLightState</span>: <span class=\"hljs-title class_\">OffLightState</span>;\n\n  <span class=\"hljs-attr\">superLightState</span>: <span class=\"hljs-title class_\">SuperLightState</span>;\n\n  <span class=\"hljs-attr\">onLightState</span>: <span class=\"hljs-title class_\">OnLightState</span>;\n\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">onLightState</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">OnLightState</span>(<span class=\"hljs-variable language_\">this</span>);\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">offLightState</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">OffLightState</span>(<span class=\"hljs-variable language_\">this</span>);\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">superLightState</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">SuperLightState</span>(<span class=\"hljs-variable language_\">this</span>);\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">offLightState</span>;\n  }\n\n  <span class=\"hljs-title function_\">setState</span>(<span class=\"hljs-params\">state: State</span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span> = state;\n  }\n}\n\n<span class=\"hljs-keyword\">const</span> light = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Light</span>();\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">assert</span>(light.<span class=\"hljs-property\">state</span> <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-title class_\">OffLightState</span>);\n\nlight.<span class=\"hljs-property\">state</span>.<span class=\"hljs-title function_\">press</span>();\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">assert</span>(light.<span class=\"hljs-property\">state</span> <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-title class_\">OnLightState</span>);\n\nlight.<span class=\"hljs-property\">state</span>.<span class=\"hljs-title function_\">press</span>();\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">assert</span>(light.<span class=\"hljs-property\">state</span> <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-title class_\">SuperLightState</span>);\n\nlight.<span class=\"hljs-property\">state</span>.<span class=\"hljs-title function_\">press</span>();\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">assert</span>(light.<span class=\"hljs-property\">state</span> <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-title class_\">OffLightState</span>);\n</code></pre>\n<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†å‡ ä¸ªä¸åŒçš„ <code>State</code> ï¼Œè¿™ä¸ªçŠ¶æ€éƒ½æœ‰ä¸€ä¸ª <code>press</code> æ–¹æ³•ï¼Œä»£è¡¨å¼€å…³è¢«æŒ‰ä¸‹æ—¶æ‰§è¡Œçš„åŠ¨ä½œï¼šåˆ‡æ¢ä¸‹ä¸€ä¸ªçŠ¶æ€</p>\n<p>ä½¿ç”¨çŠ¶æ€æ¨¡å¼åï¼Œ<strong>ä»£ç é‡æ˜æ˜¾å¢åŠ </strong>ï¼Œä½†è¿™æ ·çš„å¥½å¤„éå¸¸æ˜æ˜¾ï¼š<strong>å®ƒå¯ä»¥ä½¿æ¯ä¸€ç§çŠ¶æ€å’Œå®ƒå¯¹åº”çš„è¡Œä¸ºä¹‹é—´çš„å…³ç³»å±€éƒ¨åŒ–ï¼Œè¿™äº›è¡Œä¸ºè¢«åˆ†æ•£å’Œå°è£…åœ¨å„è‡ªå¯¹åº”çš„çŠ¶æ€ç±»ä¸­ï¼Œä¾¿äºç®¡ç†ï¼›æ­¤å¤–ï¼Œç”±äºçŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢éƒ½è¢«åˆ†å¸ƒåœ¨çŠ¶æ€ç±»å†…éƒ¨ï¼Œå› æ­¤æˆ‘ä»¬æ— éœ€ç¼–å†™è¿‡å¤šçš„ <code>if-else</code> æ¥æ§åˆ¶çŠ¶æ€ä¹‹é—´çš„è½¬æ¢</strong></p>\n<p>å½“æˆ‘ä»¬éœ€è¦ä¸º light æ–°å¢ä¸€ç§çŠ¶æ€æ—¶ï¼Œåªéœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„ <code>State</code> ç„¶åæ”¹å˜ç›¸å…³è”çš„çŠ¶æ€ä¹‹å‰çš„åˆ‡æ¢è§„åˆ™å³å¯</p>\n\n      <h2>\n        <span class=\"prefix\"></span>\n        <span class=\"content\">æ€»ç»“</span>\n        <span class=\"suffix\"></span>\n      </h2>\n    <p>çŠ¶æ€æ¨¡å¼å®šä¹‰äº†çŠ¶æ€ä¸è¡Œä¸ºä¹‹é—´çš„å…³ç³»ï¼Œè¾ƒä¸ºç»†è‡´çš„åŒºåˆ†äº†äº‹ç‰©å†…éƒ¨çš„çŠ¶æ€ï¼Œå¹¶ä¸”å°†è·Ÿæ­¤ç§çŠ¶æ€ç›¸å…³çš„è¡Œä¸ºéƒ½å°è£…åœ¨è¿™ä¸ªçŠ¶æ€å†…éƒ¨ï¼ˆæ¯”å¦‚åˆ‡æ¢åˆ°æ–°çš„çŠ¶æ€ï¼‰ï¼Œé¿å…äº† Context æ— é™è†¨èƒ€ï¼Œæ–¹ä¾¿å¢åŠ æ–°çš„çŠ¶æ€å’Œè½¬æ¢ã€‚ä½†ç”±äºæ¯ä¸ªçŠ¶æ€éƒ½éœ€è¦ä¸€ä¸ªç±»ï¼Œè¾ƒä¸ºç¹çï¼Œå¹¶ä¸”ç”±äºé€»è¾‘åˆ†æ•£åœ¨å„ä¸ªçŠ¶æ€ç±»ä¸­ï¼Œæ— å½¢ä¸­å¢åŠ äº†å¯¹æ•´ä½“çš„çŠ¶æ€æœºé€»è¾‘çš„ç†è§£éš¾åº¦</p>\n"}},"__N_SSG":true}